<!DOCTYPE html><html><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="htaccess简识"><meta name="keywords" content="htaccess"><meta name="author" content="ye1s,undefined"><meta name="copyright" content="ye1s"><title>htaccess简识【ye1s】</title><link rel="stylesheet" href="/css/fan.css"><link rel="stylesheet" href="/css/thirdparty/jquery.mCustomScrollbar.min.css"><link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4/dist/instantsearch.min.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4/dist/instantsearch-theme-algolia.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4"></script><!-- link(rel="dns-prefetch" href="https://cdn.jsdelivr.net")--><!-- link(rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.css")--><!-- script(src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.js" defer)--><!-- script(src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML")--><script src="/js/mathjax/mathjax.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
});
</script><script>var isPassword = '' || false;
if (isPassword) {
    if (prompt('请输入文章密码') !== '') {
        alert('密码错误！');
        history.back();
    }
}</script><script>window.GLOBAL_CONFIG = {
  root: '/',
  algolia: {"appId":"LKL6Q0GQJM","apiKey":"03829f64e2f5c11e4a5e2b8e51e24eb9","indexName":"blog","hits":{"per_page":10},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容:${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  gitment: {"owner":"ye1sec","repo":"comments","client_id":"d5ece338867af32b6dfa","client_secret":"2caf36bbd47977524017f95105315fc9e65f0577"},
}</script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="ye1s" type="application/atom+xml">
</head><body><canvas id="universe"></canvas><!--#body--><div id="sidebar"><div class="toggle-sidebar-info button-hover"><span data-toggle="文章目录">站点概览</span></div><div class="sidebar-toc"><div class="sidebar-toc-title">目录</div><div class="sidebar-toc-progress"><span class="progress-notice">您已阅读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc-progress-bar"></div></div><div class="sidebar-toc-content" id="sidebar-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#htaccess简介"><span class="toc-number">1.</span> <span class="toc-text">htaccess简介</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#概念"><span class="toc-number">1.1.</span> <span class="toc-text">概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#作用范围"><span class="toc-number">1.2.</span> <span class="toc-text">作用范围</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#配置"><span class="toc-number">1.3.</span> <span class="toc-text">配置</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#功能"><span class="toc-number">2.</span> <span class="toc-text">功能</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#htaccess访问控制-Allow-Deny"><span class="toc-number">2.1.</span> <span class="toc-text">htaccess访问控制(Allow&#x2F;Deny)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Order命令"><span class="toc-number">2.1.1.</span> <span class="toc-text">Order命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#过滤域名或网络主机-Allow-Deny"><span class="toc-number">2.1.2.</span> <span class="toc-text">过滤域名或网络主机(Allow&#x2F;Deny)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#禁止访问指定文件-Files"><span class="toc-number">2.1.3.</span> <span class="toc-text">禁止访问指定文件(Files)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#禁止访问指定文件类型-FilesMatch"><span class="toc-number">2.1.4.</span> <span class="toc-text">禁止访问指定文件类型(FilesMatch)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#高级访问控制-Rewrite"><span class="toc-number">2.1.5.</span> <span class="toc-text">高级访问控制(Rewrite)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#密码保护与验证"><span class="toc-number">2.2.</span> <span class="toc-text">密码保护与验证</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#配置-htaccess"><span class="toc-number">2.2.1.</span> <span class="toc-text">配置.htaccess</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#生成htpasses文件"><span class="toc-number">2.2.2.</span> <span class="toc-text">生成htpasses文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#对文件进行密码保护"><span class="toc-number">2.2.3.</span> <span class="toc-text">对文件进行密码保护</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#对指定IP进行密码保护"><span class="toc-number">2.2.4.</span> <span class="toc-text">对指定IP进行密码保护</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#目录浏览与主页"><span class="toc-number">2.3.</span> <span class="toc-text">目录浏览与主页</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#启用目录浏览"><span class="toc-number">2.3.1.</span> <span class="toc-text">启用目录浏览</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#禁用目录浏览"><span class="toc-number">2.3.2.</span> <span class="toc-text">禁用目录浏览</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#自定义目录浏览"><span class="toc-number">2.3.3.</span> <span class="toc-text">自定义目录浏览</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#配置目录主页文件"><span class="toc-number">2.3.4.</span> <span class="toc-text">配置目录主页文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#配置错误页面"><span class="toc-number">2.3.5.</span> <span class="toc-text">配置错误页面</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#重定向"><span class="toc-number">2.4.</span> <span class="toc-text">重定向</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info-avatar"><img class="author-info-avatar-img" src="/avatar.png"></div><div class="author-info-name">ye1s</div><div class="author-info-description"></div><div class="links-buttons"><a class="links-button button-hover" href="https://github.com/ye1sec" target="_blank">GitHub<i class="icon-dot bg-color9"></i></a><a class="links-button button-hover" href="mailto:431774437@qq.com" target="_blank">E-Mail<i class="icon-dot bg-color3"></i></a><a class="links-button button-hover" href="tencent://message/?uin=431774437&amp;Site=&amp;Menu=yes" target="_blank">QQ<i class="icon-dot bg-color5"></i></a></div><div class="author-info-articles"><a class="author-info-articles-archives article-meta" href="/archives"><span class="pull-top">日志</span><span class="pull-bottom">200</span></a><a class="author-info-articles-tags article-meta" href="/tags"><span class="pull-top">标签</span><span class="pull-bottom">149</span></a><a class="author-info-articles-categories article-meta" href="/categories"><span class="pull-top">分类</span><span class="pull-bottom">12</span></a></div><div class="friend-link"><a class="friend-link-text" href="http://www.m00nback.xyz/" target="_blank">MoonBack</a><a class="friend-link-text" target="_blank">待定</a></div></div></div><div id="main-container"><header><div id="menu-outer"><i class="menu-list-icon fas fa-bars"></i><nav id="menu-inner"><a class="menu-item" href="/">首页</a><a class="menu-item" href="/tags">标签</a><a class="menu-item" href="/categories">分类</a><a class="menu-item" href="/archives">归档</a><a class="menu-item" href="/about">关于</a></nav><div class="right-info"><a class="search social-icon"><i class="fas fa-search"></i><span> 搜索</span></a><a class="title-name" href="/">ye1s</a><span id="now-time"></span></div></div></header><div id="content-outer"><div id="content-inner"><article id="post"><div class="post-header"><div class="title">htaccess简识</div><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 发表于 2020-09-01 | 更新于 2020-09-17</time><!--time.button-hover.post-date #[i.fas.fa-calendar-alt.article-icon(aria-hidden="true")] #[=__('post.modified')] #[=date(page['updated'], config.date_format)]--><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/web%E5%AE%89%E5%85%A8/">web安全</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/htaccess/">htaccess</a></div></div></div><div class="main-content"><p>对htaccess的认识只停留在文件上传黑名单的绕过，还是得好好学习一下。</p>
<a id="more"></a>
<h1 id="htaccess简介"><a href="#htaccess简介" class="headerlink" title="htaccess简介"></a>htaccess简介</h1><h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p><code>.htaccess</code> 文件(或者”分布式配置文件”）提供了针对目录改变配置的方法， 即，在一个特定的文档目录中放置一个包含一个或多个指令的文件， 以作用于此目录及其所有子目录。作为用户，所能使用的命令受到限制。管理员可以通过 <code>Apache</code> 的 <code>AllowOverride</code> 指令来设置。</p>
<p>概述来说，<code>htaccess</code> 文件是Apache服务器中的一个配置文件，它负责相关目录下的网页配置。通过htaccess文件，可以帮我们实现：网页301重定向、自定义404错误页面、改变文件扩展名、允许/阻止特定的用户或者目录的访问、禁止目录列表、配置默认文档等功能。</p>
<h2 id="作用范围"><a href="#作用范围" class="headerlink" title="作用范围"></a>作用范围</h2><p><code>.htaccess</code> 文件中的配置指令作用于 <code>.htaccess</code> 文件所在的目录及其所有子目录，但是很重要的、需要注意的是，其上级目录也可能会有 <code>.htaccess</code> 文件，而指令是按查找顺序依次生效的，所以一个特定目录下的 <code>.htaccess</code> 文件中的指令可能会覆盖其上级目录中的 <code>.htaccess</code> 文件中的指令，即子目录中的指令会覆盖父目录或者主配置文件中的指令。 </p>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>通常情况下，Apache是默认启用 <code>.htaccess</code> 的，但是为了以防万一，请检查一下自己站点的配置文件，如 <code>httpd.conf</code>，是否有这行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AllowOverride All</span><br></pre></td></tr></table></figure>
<p>这行允许重写配置文件。也就是如果能够从 <code>.htaccess</code> 加载配置文件，那么就以 <code>.htaccess</code> 为配置文件对其所在目录进行配置。</p>
<h1 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h1><p><a href="https://blog.csdn.net/qq_21956483/article/details/79448811" target="_blank" rel="noopener">.htaccess简介</a><br>通过功能，顺便认识一下语法  </p>
<h2 id="htaccess访问控制-Allow-Deny"><a href="#htaccess访问控制-Allow-Deny" class="headerlink" title="htaccess访问控制(Allow/Deny)"></a>htaccess访问控制(Allow/Deny)</h2><h3 id="Order命令"><a href="#Order命令" class="headerlink" title="Order命令"></a>Order命令</h3><p>为了限制用户访问一些关键目录，.htaccess可以提供目录访问限制。你只需要在要限制的目录中，加入如下.htaccess文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deny from all</span><br></pre></td></tr></table></figure>
<p>这会限制所有用户通过浏览器访问该目录，允许指定IP地址的访问：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Order Allow,Deny</span><br><span class="line">Allow from 192.168.0.0/16</span><br></pre></td></tr></table></figure>
<p>Order命令是一个难点，也是配置apache的基础，它决定了Apache处理访问规则的顺序。</p>
<ul>
<li>通过Allow,Deny参数，Apache首先找到并应用Allow命令，然后应用Deny命令，以阻止所有访问。</li>
<li>通过Deny,Allow参数，Apache首先找到并应用Deny命令，然后应用Allow命令，以允许所有访问。  </li>
</ul>
<p>然后我在本地尝试发现如下配置，也限制了192.168.0.0/16网段主机的访问，去掉 Deny from All 则可以访问  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Order Allow,Deny</span><br><span class="line">Deny from All</span><br><span class="line">Allow from 192.168.0.0/16</span><br></pre></td></tr></table></figure>
<h3 id="过滤域名或网络主机-Allow-Deny"><a href="#过滤域名或网络主机-Allow-Deny" class="headerlink" title="过滤域名或网络主机(Allow/Deny)"></a>过滤域名或网络主机(Allow/Deny)</h3><p>下例可以限制所有含有“domain.com”的网络主机访问网站：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Order Allow,Deny</span><br><span class="line">Allow from all</span><br><span class="line">Deny from .*domain\.com.*</span><br></pre></td></tr></table></figure>
<h3 id="禁止访问指定文件-Files"><a href="#禁止访问指定文件-Files" class="headerlink" title="禁止访问指定文件(Files)"></a>禁止访问指定文件(Files)</h3><p>Files命令可以用于过滤指定文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;Files test.php&gt;</span><br><span class="line"> order allow,deny</span><br><span class="line"> deny from all</span><br><span class="line">&lt;/Files&gt;</span><br></pre></td></tr></table></figure>
<h3 id="禁止访问指定文件类型-FilesMatch"><a href="#禁止访问指定文件类型-FilesMatch" class="headerlink" title="禁止访问指定文件类型(FilesMatch)"></a>禁止访问指定文件类型(FilesMatch)</h3><p>下面的代码将限制访问所有.log和.exe文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;FilesMatch <span class="string">".(log|exe)$"</span>&gt;</span><br><span class="line"> Order allow,deny</span><br><span class="line"> Deny from all</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure>
<p>我们还可以通过Files命令描述文件类型，但是需要在命令后面加一个波浪线(~)，该符号启用Files命令的正则表达解析功能：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;Files ~ <span class="string">"^.*\.([Ll][Oo][Gg])|([eE][xX][eE])"</span>&gt;</span><br><span class="line"> Order allow,deny</span><br><span class="line"> Deny from all</span><br><span class="line"> Satisfy All</span><br><span class="line">&lt;/Files&gt;</span><br></pre></td></tr></table></figure>
<p>有以下几点需要注意：</p>
<ul>
<li>Files之后的波浪线用于开启“正则表达式”分析。请注意，这是个过时的用法，Apache更推荐使用<a href="http://httpd.apache.org/docs/2.2/mod/core.html#files" target="_blank" rel="noopener"><code>&lt;FilesMatch&gt;</code></a>指令</li>
<li>正则表达式必须在双引号之间，有关htaccess的正则表达式用法，请查阅本站<a href="http://lesca.me/archives/htaccess-appendix.html#htaccess_regex" target="_blank" rel="noopener">《.htaccess正则表达式》</a>一文。  </li>
<li>双引号中的“管道符”(|)用于将两种文件类型（.log和.exe）分开，相当于逻辑“或”</li>
<li>Order命令必须嵌在Files节(Section)中，否则将会应用到所有文件</li>
<li>Satisfy All表示必须同时满足主机级别(Allow/Denay)和用户级别(Require)的限制，All是默认值，该行可以省略。  </li>
</ul>
<h3 id="高级访问控制-Rewrite"><a href="#高级访问控制-Rewrite" class="headerlink" title="高级访问控制(Rewrite)"></a>高级访问控制(Rewrite)</h3><p>还可以通过运用Rewrite实现更强大的访问控制<br>详情可看：<a href="http://lesca.me/archives/htaccess-rewrite.html#access_control" target="_blank" rel="noopener">http://lesca.me/archives/htaccess-rewrite.html#access_control</a> </p>
<p>开启mod_rewrite </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo a2enmod rewrite</span><br></pre></td></tr></table></figure>
<p>需要注意点：   </p>
<ul>
<li>FollowSymlinks必须启用，这是rewrite引擎的安全需求。</li>
<li>通常FollowSymlinks在Apache的主配置文件中就已经启用了，所以通常可以省略。</li>
<li>RewriteEngine命令用于启用rewrite引擎</li>
<li>IfModule命令用于判断Apache是否安装了mod_rewrite模块，之后笔者会省略该命令，但不代表这是个好习惯</li>
<li>mod_rewrite会处理所有提交给Apache的URL请求，并与之后的规则进行匹配   </li>
</ul>
<h2 id="密码保护与验证"><a href="#密码保护与验证" class="headerlink" title="密码保护与验证"></a>密码保护与验证</h2><h3 id="配置-htaccess"><a href="#配置-htaccess" class="headerlink" title="配置.htaccess"></a>配置.htaccess</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">AuthType Basic</span><br><span class="line">AuthName <span class="string">"restricted area"</span></span><br><span class="line">AuthUserFile /var/www/passwd</span><br><span class="line">require valid-user</span><br></pre></td></tr></table></figure>
<p>这个配置文件可以保护.htaccess所在的整个目录，简单说明下参数：</p>
<ul>
<li>AuthType：验证类型为基本类型，密码以明文方式传输到服务器上</li>
<li>AuthName：验证提示，会出现在验证对话框中</li>
<li>AuthUserFile：验证配置文件，用于匹配用户名与密码，该密码是加密保存的</li>
<li>require valid-user：只有在AuthUserFile中出现的用户才可以通过验证<h3 id="生成htpasses文件"><a href="#生成htpasses文件" class="headerlink" title="生成htpasses文件"></a>生成htpasses文件</h3>如何生成passwd文件呢？我们通过htpasswd命令生成密码文件：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">htpasswd -c /var/www/passwd</span><br></pre></td></tr></table></figure>
它会提示你输入密码，并确认。之后将密码文件passwd保存在/var/www/目录下</li>
</ul>
<h3 id="对文件进行密码保护"><a href="#对文件进行密码保护" class="headerlink" title="对文件进行密码保护"></a>对文件进行密码保护</h3><p>保护与.htaccess在同一目录下的文件secure.php：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># password-protect single file</span></span><br><span class="line">&lt;Files secure.php&gt;</span><br><span class="line">AuthType Basic</span><br><span class="line">AuthName <span class="string">"Prompt"</span></span><br><span class="line">AuthUserFile /var/www/passwd</span><br><span class="line">Require valid-user</span><br><span class="line">&lt;/Files&gt;</span><br></pre></td></tr></table></figure>
<p>保护.htaccess所在目录下的多个文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># password-protect multiple files</span></span><br><span class="line">&lt;FilesMatch <span class="string">"^(execute|index|secure|insanity|biscuit)*$"</span>&gt;</span><br><span class="line">AuthType basic</span><br><span class="line">AuthName <span class="string">"Development"</span></span><br><span class="line">AuthUserFile /var/www/passwd</span><br><span class="line">Require valid-user</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure>
<h3 id="对指定IP进行密码保护"><a href="#对指定IP进行密码保护" class="headerlink" title="对指定IP进行密码保护"></a>对指定IP进行密码保护</h3><p>仅允许IP地址为192.168.10.5的主机直接访问该目录，其他IP需要验证。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">AuthType Basic</span><br><span class="line">AuthName <span class="string">"Personal"</span></span><br><span class="line">AuthUserFile /var/www/passwd</span><br><span class="line">Require valid-user</span><br><span class="line">Allow from 192.168.10.5</span><br><span class="line">Satisfy Any</span><br></pre></td></tr></table></figure>
<h2 id="目录浏览与主页"><a href="#目录浏览与主页" class="headerlink" title="目录浏览与主页"></a>目录浏览与主页</h2><h3 id="启用目录浏览"><a href="#启用目录浏览" class="headerlink" title="启用目录浏览"></a>启用目录浏览</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Options All +Indexes</span><br></pre></td></tr></table></figure>
<h3 id="禁用目录浏览"><a href="#禁用目录浏览" class="headerlink" title="禁用目录浏览"></a>禁用目录浏览</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Options All -Indexes</span><br></pre></td></tr></table></figure>
<p>我们还可以通过IndexIgnore指令来禁用目录浏览。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IndexIgnore *</span><br></pre></td></tr></table></figure>
<p>通过IndexIgnore指令，我们可以禁止对指定类型的文件浏览：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IndexIgnore *.wmv *.mp4 *.avi *.etc</span><br></pre></td></tr></table></figure>
<h3 id="自定义目录浏览"><a href="#自定义目录浏览" class="headerlink" title="自定义目录浏览"></a>自定义目录浏览</h3><p>如果你希望Apache在展示你的WEB目录时看起来与众不同，那么你需要启用FancyIndexing选项：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;IfModule mod_autoindex.c&gt;</span><br><span class="line"> IndexOptions FancyIndexing </span><br><span class="line">&lt;&#x2F;ifModule&gt;</span><br></pre></td></tr></table></figure>
<p>通过这个选项，你可以实现自定义图标、添加文件类型描述、按日期排序等。</p>
<h3 id="配置目录主页文件"><a href="#配置目录主页文件" class="headerlink" title="配置目录主页文件"></a>配置目录主页文件</h3><p>即使启用了目录浏览，Apache未必会展示该目录的内容，因为该目录可能存在像index.htm这样的默认主页文件。Apache会有限展示主页文件，我们可以通过.htaccess设置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DirectoryIndex index.html index.php index.htm</span><br></pre></td></tr></table></figure>
<h3 id="配置错误页面"><a href="#配置错误页面" class="headerlink" title="配置错误页面"></a>配置错误页面</h3><p>如果Apache遇到错误，就会输出错误页面。配置自定义的错误页面，也许可以挽留即将离开的用户。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># custom error documents</span><br><span class="line">ErrorDocument 401 &#x2F;err&#x2F;401.php</span><br><span class="line">ErrorDocument 403 &#x2F;err&#x2F;403.php</span><br><span class="line">ErrorDocument 404 &#x2F;err&#x2F;404.php</span><br><span class="line">ErrorDocument 500 &#x2F;err&#x2F;500.php</span><br></pre></td></tr></table></figure>
<h2 id="重定向"><a href="#重定向" class="headerlink" title="重定向"></a>重定向</h2><p>old_dir 重新定向到 new_dir, 也可以定向到其他 WEB 站点目录       </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Redirect /old_dir/ http://www.yourdomain.com/new_dir/index.html</span><br></pre></td></tr></table></figure>


<p>参考文章：</p>
<p><a href="https://www.cnblogs.com/Wanghaoran-s1mple/p/13152075.html" target="_blank" rel="noopener">深究.htaccess的原理，和用户利用其恶意篡改服务器配值导致的深层安全问题</a><br><a href="https://www.cnblogs.com/Wanghaoran-s1mple/p/13232888.html" target="_blank" rel="noopener">借github上韩国师傅的一个源码实例再次理解.htaccess的功效</a><br><a href="https://github.com/sektioneins/pcc/wiki/PHP-htaccess-injection-cheat-sheet" target="_blank" rel="noopener">PHP htaccess injection cheat sheet
</a><br><a href="https://blog.csdn.net/qq_21956483/article/details/79448811" target="_blank" rel="noopener">.htaccess简介</a><br><a href="https://www.cnblogs.com/adforce/archive/2012/11/23/2784664.html" target="_blank" rel="noopener">.htaccess 详解</a><br><a href="http://www.htaccess-guide.com/" target="_blank" rel="noopener">Apache .htaccess Guide, Tutorials and Articles</a><br><a href="https://www.anquanke.com/post/id/205098" target="_blank" rel="noopener">.htaccess利用与Bypass方式总结</a><br><a href="https://www.freebuf.com/vuls/218495.html" target="_blank" rel="noopener">Apache中.htaccess文件利用的总结与新思路拓展</a></p>
</div><div class="post-copyright"><div class="post-copyright-author"><span class="post-copyright-meta">本文作者: </span><span class="post-copyright-info"><a href="mailto:undefined">ye1s</a></span></div><div class="post-copyright-type"><span class="post-copyright-meta">本文链接: </span><span class="post-copyright-info"><a href="https://blog.cfyqy.com/article/2b398cc5.html">https://blog.cfyqy.com/article/2b398cc5.html</a></span></div><div class="post-copyright-notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.cfyqy.com">ye1s</a>！</span></div></div><div class="post-copyright" id="comments-container"><script src="/js/comments/gitment.js"></script></div><script>let arr = location.href.split('/#more')[0].split('/');
let title = arr[arr.length - 1];
if (title === '') {
    title = arr[arr.length - 2]
}
var flag = false;
var gitFun = function () {
    try {
        var gitmentObj = window.GLOBAL_CONFIG.gitment;
        var gitment = new Gitment({
            id: decodeURI(title), // 可选。默认为 location.href
            owner: gitmentObj.owner,
            repo: gitmentObj.repo,
            oauth: {
                client_id: gitmentObj.client_id,
                client_secret: gitmentObj.client_secret
            },
        });
        gitment.render('comments-container');
        flag = true;
    } catch (e) {
        flag = false;
    }
}
var setIn = setInterval(() => {
    if (!flag) {
        gitFun();
    } else {
        clearInterval(setIn);
    }
}, 200);</script></article><div id="pagination"><div class="prev-post pull-left"><span class="line line-top"></span><span class="line line-right"></span><span class="line line-bottom"></span><span class="line line-left"></span><a href="/article/6b6ad1b0.html"><i class="fas fa-angle-left">&nbsp;</i><span>Apache的.htaccess利用技巧</span></a></div><div class="next-post pull-right"><span class="line line-top"></span><span class="line line-right"></span><span class="line line-bottom"></span><span class="line line-left"></span><a href="/article/13364c14.html"><span>PHP file_put_contents 的死亡绕过</span><span>&nbsp;</span><i class="fas fa-angle-right"></i></a></div></div><!--div!= paginator()--></div></div><div class="button-hover" id="return-top"><i class="fas fa-arrow-up" aria-hidden="true"></i></div><footer><div id="footer"><div class="button-hover" id="side-button"><i class="fas fa-arrow-right"></i></div><div class="right-content"><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fas fa-file-o"></i></span><span id="busuanzi_value_page_pv"></span><span></span></div><div class="copyright">&copy;2017 ～ 2021 By ye1s</div></div></div></footer></div><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/jquery-3.3.1.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/velocity.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/jquery.mCustomScrollbar.concat.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/fan.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/canvas_bg.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/utils.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/scroll.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/sidebar.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/copy.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/daovoice.js"></script><!--script(src=url)--><div class="search-dialog"><div id="algolia-search-title">Algolia</div><div class="search-close-button"><i class="fa fa-times"></i></div><!--div#current-refined-values--><!--div#clear-all--><div id="search-box"></div><!--div#refinement-list--><hr><div id="hits"></div><div id="algolia-pagination"></div></div><div class="search-mask"></div><script src="/js/search/algolia.js"></script></body></html>